# 阿里Java开发手册印象深刻的规约举例

我看过阿里巴巴Java开发手册，里面有很多非常实用、业界影响很大的编码规范和建议。印象最深刻的有以下几条：

---

### 1. **不要通过 `Executors` 创建线程池**

> 规约：线程池不允许使用 Executors 去创建，而是通过 ThreadPoolExecutor 的方式，这样的处理方式更加明确线程池的运行规则，规避资源耗尽的风险。

**理由：**  
`Executors.newFixedThreadPool`、`newCachedThreadPool` 这些方法容易让开发者忽略队列长度和最大线程数，可能导致 OOM。推荐自己指定参数，明确线程池行为。

---

### 2. **RPC/接口返回值不使用基本类型，应使用包装类型**

> 规约：所有的 POJO 类属性必须使用包装数据类型（如 Integer、Long），RPC/接口返回值也不得使用基本数据类型。

**理由：**  
基本类型有默认值，调用方很难区分“0”和“没有值”，容易引发歧义和隐患。包装类型可以用 null 表达“无数据”。

---

### 3. **SimpleDateFormat 非线程安全，禁止定义为静态变量**

> 规约：SimpleDateFormat 是线程不安全的，禁止定义为 static 变量。

**理由：**  
SimpleDateFormat 属于典型的线程不安全类，静态变量会被多线程同时使用，容易导致日期格式化异常。推荐每次使用时 new 一个实例，或用 `ThreadLocal<SimpleDateFormat>`、`DateTimeFormatter` 替代。

---

### 4. **不要直接使用日志实现类，如 Log4j/Logback**

> 规约：应用中必须使用 slf4j 作为日志接口，不要直接调用日志实现类。

**理由：**  
使用日志门面（slf4j）可以灵活切换底层日志实现，增强系统可维护性和可扩展性。

---

### 5. **BigDecimal 的构造方法优先用 String，禁止用 double**

> 规约：禁止使用 new BigDecimal(double) 的方式。

**理由：**  
double 本身不是精确的二进制浮点表示，直接用 double 构造 BigDecimal 会有精度丢失，推荐用字符串构造。

---

### 6. **数据库表不建议使用外键**

> 规约：表之间不建议建立外键约束，所有外键约束必须在应用层解决。

**理由：**  
外键会影响数据库的扩展性、分库分表、性能和灵活性，业务完整性在应用层保障更灵活。

---

### 7. **HashMap 初始化容量要估算，避免频繁扩容**

> 规约：HashMap 使用时，建议指定初始容量。

**理由：**  
HashMap 扩容代价高，频繁扩容影响性能，建议根据实际数据量设定合理初始容量。

---

## 总结

阿里Java开发手册里的这些规约，很多都来源于实际踩坑经验，能极大提升代码质量和系统稳定性。  
我个人印象最深的是**“线程池不要用 Executors 工厂方法创建”**，很多新手都会忽略这个问题，后果可能是线上OOM，非常实用！

---
## MySQL 如何避免全表扫描？

### 1. 合理设计和使用索引
- 为常用的查询条件、排序、分组字段建立合适的索引（单列索引、联合索引）。
- 查询时要利用索引的最左前缀原则，避免索引失效。

### 2. 查询条件要能命中索引
- WHERE 子句使用被索引的字段。
- 避免在索引字段上使用函数或表达式（如 `WHERE YEAR(create_time) = 2023`），否则索引失效。
- 避免对索引字段进行隐式类型转换（如字符串和数字混用）。

### 3. 避免模糊查询导致索引失效
- LIKE 查询中，避免以 `%` 开头（如 `LIKE '%abc'`），前缀匹配（如 `LIKE 'abc%'`）能用上索引。

### 4. 不要在索引列上使用 OR
- `WHERE a=1 OR b=2` 这种多字段OR条件，可能导致索引失效，建议拆分或用 UNION。

### 5. 合理使用覆盖索引（索引覆盖查询）
- 只查询索引能覆盖的字段，避免回表，提高效率。

### 6. 利用 EXPLAIN 分析执行计划
- 用 `EXPLAIN` 查看SQL是否走索引，及时发现和优化全表扫描问题。

---

## 常见导致全表扫描的场景

- 无索引或索引未命中。
- 使用了不支持索引的操作（如函数、表达式、隐式转换）。
- 使用 `%abc` 这类前缀模糊匹配。
- 数据量极少（MySQL优化器可能认为全表扫描比走索引更快）。

---

## 总结性口诀

> **建好索引，写好SQL，善用EXPLAIN，避免全表扫描。**

---

## 面试官可能追问

1. **如何判断一条SQL是否走索引？**  
   - 用 `EXPLAIN` 语句，看 type 字段是否为 index、range，key 字段是否为期望的索引。

2. **哪些SQL写法容易导致索引失效？**  
   - 对索引字段做函数/运算、类型不一致、OR连接不同字段、前置百分号模糊查询等。

3. **什么是覆盖索引？为什么能提高查询效率？**  
   - 覆盖索引指查询只访问索引而无需回表，减少IO，提高性能。

---
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß† ÂÖ´ËÇ°ÊñáÂ§ç‰π†Á≥ªÁªü - javaminus</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei UI", "SF Pro Display", "Segoe UI", sans-serif;
            background: linear-gradient(135deg, #0D1117 0%, #161B22 100%);
            color: #F0F6FC;
            overflow-x: hidden;
        }

        /* ‰∏ªÂ∏ÉÂ±Ä */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Ê†áÈ¢òÊ†è */
        .title-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(90deg, #58A6FF 0%, #7C3AED 100%);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 2px 10px rgba(88, 166, 255, 0.3);
            z-index: 1000;
        }

        .title-text {
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        .user-info {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        /* ‰æßËæπÊ†è */
        .sidebar {
            width: 250px;
            background: #161B22;
            padding: 80px 20px 20px;
            border-right: 1px solid #30363D;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .nav-button {
            width: 100%;
            padding: 15px 20px;
            margin-bottom: 10px;
            background: transparent;
            color: #7D8590;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
            text-align: left;
        }

        .nav-button:hover {
            background: #21262D;
            color: #58A6FF;
            box-shadow: 0 1px 5px rgba(88, 166, 255, 0.2);
            transform: translateX(5px);
        }

        .nav-button.active {
            background: #58A6FF;
            color: white;
            box-shadow: 0 2px 8px rgba(88, 166, 255, 0.4);
        }

        /* ‰∏ªÂÜÖÂÆπÂå∫ */
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 80px 30px 30px;
            min-height: 100vh;
        }

        /* Âç°ÁâáÊ†∑Âºè */
        .card {
            background: #161B22;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #30363D;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 8px 20px rgba(88, 166, 255, 0.2);
            border-color: #58A6FF;
        }

        /* ÈóÆÈ¢òÂç°Áâá */
        .question-card {
            background: linear-gradient(135deg, #161B22 0%, #1C2128 100%);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid #30363D;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            min-height: 300px;
        }

        .question-text {
            font-size: 28px;
            line-height: 1.6;
            color: #F0F6FC;
            margin-bottom: 20px;
        }

        /* ÊåâÈíÆÊ†∑Âºè */
        .btn-primary {
            background: linear-gradient(135deg, #58A6FF 0%, #7C3AED 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 3px 10px rgba(88, 166, 255, 0.3);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            box-shadow: 0 5px 15px rgba(88, 166, 255, 0.5);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            color: #58A6FF;
            border: 2px solid #58A6FF;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(88, 166, 255, 0.1);
            box-shadow: 0 2px 8px rgba(88, 166, 255, 0.3);
        }

        .btn-danger {
            background: transparent;
            color: #F85149;
            border: 2px solid #F85149;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-danger:hover {
            background: rgba(248, 81, 73, 0.1);
            box-shadow: 0 2px 8px rgba(248, 81, 73, 0.3);
        }

        /* ËØ≠Èü≥ÊåâÈíÆ */
        .voice-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #F85149 0%, #FF6B9D 100%);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(248, 81, 73, 0.4);
            transition: all 0.3s ease;
        }

        .voice-btn:hover {
            box-shadow: 0 8px 20px rgba(248, 81, 73, 0.6);
            transform: scale(1.1);
        }

        .voice-btn.recording {
            background: linear-gradient(135deg, #3FB950 0%, #06D6A0 100%);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* ËæìÂÖ•Ê°ÜÊ†∑Âºè */
        .form-input {
            width: 100%;
            padding: 15px;
            background: #21262D;
            color: #F0F6FC;
            border: 2px solid #30363D;
            border-radius: 10px;
            font-size: 20px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #58A6FF;
            box-shadow: 0 0 5px rgba(88, 166, 255, 0.3);
        }

        textarea.form-input {
            resize: vertical;
            min-height: 120px;
        }

        /* ËøõÂ∫¶Êù° */
        .progress-container {
            background: #21262D;
            border-radius: 10px;
            height: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #58A6FF 0%, #3FB950 100%);
            transition: width 0.3s ease;
            border-radius: 8px;
        }

        /* ÁªüËÆ°Âç°Áâá */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #161B22 0%, #1C2128 100%);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid #30363D;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        .stat-number {
            color: #58A6FF;
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #7D8590;
            font-size: 14px;
        }

        /* Ê®°ÊÄÅÊ°Ü */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #161B22;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid #30363D;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }

        .close-btn {
            background: none;
            border: none;
            color: #7D8590;
            font-size: 24px;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #F85149;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 80px 15px 15px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
        }

        /* Âä®ÁîªÊïàÊûú */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-in {
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(-30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ÈöêËóèÂÖÉÁ¥† */
        .hidden {
            display: none !important;
        }

        /* Â∏ÉÂ±Ä */
        .flex {
            display: flex;
        }

        .flex-center {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flex-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .gap-10 {
            gap: 10px;
        }

        .gap-15 {
            gap: 15px;
        }

        .gap-20 {
            gap: 20px;
        }

        .mb-10 {
            margin-bottom: 10px;
        }

        .mb-15 {
            margin-bottom: 15px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mt-20 {
            margin-top: 20px;
        }

        /* È¢òÁõÆÂàóË°® */
        .question-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #30363D;
            border-radius: 10px;
            background: #21262D;
        }

        .question-item {
            padding: 15px;
            border-bottom: 1px solid #30363D;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-item:hover {
            background: #30363D;
        }

        .question-item.selected {
            background: rgba(88, 166, 255, 0.2);
            border-left: 4px solid #58A6FF;
        }

        .question-item:last-child {
            border-bottom: none;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .question-meta {
            font-size: 15px;
            color: #7D8590;
        }

        /* Âø´Êç∑ÈîÆÊèêÁ§∫ */
        .shortcuts {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid #30363D;
        }

        .shortcut-title {
            color: #7D8590;
            font-size: 20px;
            margin-bottom: 10px;
        }

        .shortcut-item {
            color: #7D8590;
            font-size: 20px;
            margin-bottom: 5px;
        }

        /* Ë°®Ê†ºÊ†∑Âºè */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #30363D;
        }

        .table th {
            background: #21262D;
            color: #F0F6FC;
            font-weight: bold;
        }

        .table td {
            color: #7D8590;
        }

        .table tr:hover {
            background: rgba(88, 166, 255, 0.1);
        }

        /* ÂàÜÈ°µ */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .page-btn {
            padding: 8px 12px;
            background: transparent;
            color: #58A6FF;
            border: 1px solid #58A6FF;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn:hover,
        .page-btn.active {
            background: #58A6FF;
            color: white;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <!-- Ê†áÈ¢òÊ†è -->
    <div class="title-bar">
        <div class="title-text">üß† ÂÖ´ËÇ°ÊñáÂ§ç‰π†Á≥ªÁªü</div>
        <div class="user-info">Welcome, javaminus!</div>
    </div>

    <div class="app-container">
        <!-- ‰æßËæπÊ†è -->
        <div class="sidebar">
            <button class="nav-button active" data-page="review">üéØ ÂºÄÂßãÂ§ç‰π†</button>
            <button class="nav-button" data-page="manage">üìö È¢òÁõÆÁÆ°ÁêÜ</button>
            <button class="nav-button" data-page="statistics">üìä ÁªüËÆ°ÂàÜÊûê</button>
            <button class="nav-button" data-page="settings">‚öôÔ∏è ËÆæÁΩÆ</button>
            
            <div class="shortcuts">
                <div class="shortcut-title">üí° Âø´Êç∑ÈîÆ</div>
                <div class="shortcut-item">Space - ËØ≠Èü≥ÂõûÁ≠î</div>
                <div class="shortcut-item">Enter - Êèê‰∫§Á≠îÊ°à</div>
                <div class="shortcut-item">‚Üí - ‰∏ã‰∏ÄÈ¢ò</div>
                <div class="shortcut-item">‚Üê - ‰∏ä‰∏ÄÈ¢ò</div>
            </div>
        </div>

        <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
        <div class="main-content">
            <!-- Â§ç‰π†È°µÈù¢ -->
            <div id="review-page" class="page">
                <!-- ËøõÂ∫¶Âå∫Âüü -->
                <div class="card">
                    <div class="flex-between mb-15">
                        <div id="progress-text">È¢òÁõÆ 1 / 0</div>
                        <div class="flex gap-10">
                            <button class="btn-secondary" onclick="showHint()">üí° ÊèêÁ§∫</button>
                            <button class="btn-secondary" onclick="readQuestion()">üîä ÊúóËØª</button>
                            <button class="btn-secondary" id="mode-btn" onclick="toggleMode()">üìë È°∫Â∫è</button>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                </div>

                <!-- È¢òÁõÆÊòæÁ§∫Âå∫Âüü -->
                <div class="question-card fade-in">
                    <div class="question-text" id="question-text">
                        Ê¨¢Ëøé‰ΩøÁî®ÂÖ´ËÇ°ÊñáÂ§ç‰π†Á≥ªÁªüÔºÅËØ∑ÂÖàÊ∑ªÂä†‰∏Ä‰∫õÈ¢òÁõÆÂºÄÂßãÂ§ç‰π†„ÄÇ
                    </div>
                </div>

                <!-- Á≠îÈ¢òÂå∫Âüü -->
                <div class="card">
                    <div class="flex-center gap-20 mb-20">
                        <button class="voice-btn" id="voice-btn" onclick="toggleVoiceRecording()">üé§</button>
                        <span style="color: #7D8590;">Êàñ</span>
                        <button class="btn-secondary" onclick="focusAnswerArea()">üìù ÊñáÊú¨ÂõûÁ≠î</button>
                    </div>
                    
                    <textarea id="answer-area" class="form-input mb-20" placeholder="ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÁ≠îÊ°à..." rows="8"></textarea>
                    
                    <div class="flex-between">
                        <div class="flex gap-15">
                            <button class="btn-primary" onclick="submitAnswer()">Êèê‰∫§Á≠îÊ°à</button>
                            <button class="btn-secondary" onclick="showAnswer()">Êü•ÁúãÁ≠îÊ°à</button>
                        </div>
                        <div class="flex gap-10">
                            <button class="btn-secondary" onclick="previousQuestion()">‚Üê ‰∏ä‰∏ÄÈ¢ò</button>
                            <button class="btn-primary" onclick="nextQuestion()">‰∏ã‰∏ÄÈ¢ò ‚Üí</button>
                        </div>
                    </div>
                </div>

                <!-- ÁªüËÆ°‰ø°ÊÅØ -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="correct-count">0</div>
                        <div class="stat-label">Á≠îÂØπÈ¢òÊï∞</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-count">0</div>
                        <div class="stat-label">ÊÄªÈ¢òÊï∞</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="accuracy-rate">0%</div>
                        <div class="stat-label">Ê≠£Á°ÆÁéá</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="time-spent">00:00</div>
                        <div class="stat-label">Áî®Êó∂</div>
                    </div>
                </div>
            </div>

            <!-- È¢òÁõÆÁÆ°ÁêÜÈ°µÈù¢ -->
            <div id="manage-page" class="page hidden">
                <div style="display: grid; grid-template-columns: 1fr 1.5fr; gap: 20px;">
                    <!-- Â∑¶‰æßÈ¢òÁõÆÂàóË°® -->
                    <div class="card">
                        <div class="flex-between mb-20">
                            <h3>üìö È¢òÁõÆÂàóË°®</h3>
                            <button class="btn-primary" onclick="addNewQuestion()">‚ûï Ê∑ªÂä†È¢òÁõÆ</button>
                        </div>
                        <div class="question-list" id="question-list">
                            <!-- È¢òÁõÆÂàóË°®Âä®ÊÄÅÁîüÊàê -->
                        </div>
                    </div>

                    <!-- Âè≥‰æßÈ¢òÁõÆËØ¶ÊÉÖ -->
                    <div class="card">
                        <h3 class="mb-20">üìù È¢òÁõÆËØ¶ÊÉÖ</h3>
                        
                        <div class="flex gap-15 mb-15">
                            <div style="flex: 1;">
                                <label style="color: #F0F6FC; display: block; margin-bottom: 5px;">ÂàÜÁ±ª:</label>
                                <input type="text" id="question-category" class="form-input" placeholder="ÂàÜÁ±ª">
                            </div>
                            <div style="flex: 1;">
                                <label style="color: #F0F6FC; display: block; margin-bottom: 5px;">ÈöæÂ∫¶:</label>
                                <select id="question-difficulty" class="form-input">
                                    <option value="EASY">ÁÆÄÂçï</option>
                                    <option value="MEDIUM">‰∏≠Á≠â</option>
                                    <option value="HARD">Âõ∞Èöæ</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-15">
                            <label style="color: #F0F6FC; display: block; margin-bottom: 5px;">È¢òÁõÆÊ†áÈ¢ò:</label>
                            <input type="text" id="question-title" class="form-input" placeholder="ËØ∑ËæìÂÖ•È¢òÁõÆÊ†áÈ¢ò">
                        </div>
                        
                        <div class="mb-15">
                            <label style="color: #F0F6FC; display: block; margin-bottom: 5px;">È¢òÁõÆÂÜÖÂÆπ:</label>
                            <textarea id="question-content" class="form-input" placeholder="ËØ∑ËæìÂÖ•È¢òÁõÆÂÜÖÂÆπ" rows="6"></textarea>
                        </div>
                        
                        <div class="mb-20">
                            <label style="color: #F0F6FC; display: block; margin-bottom: 5px;">ÊèêÁ§∫ÂÜÖÂÆπ:</label>
                            <textarea id="question-hint" class="form-input" placeholder="ËØ∑ËæìÂÖ•ÊèêÁ§∫ÂÜÖÂÆπ" rows="3"></textarea>
                        </div>
                        
                        <div class="flex gap-15">
                            <button class="btn-primary" onclick="saveQuestion()">üíæ ‰øùÂ≠ò</button>
                            <button class="btn-danger" onclick="deleteQuestion()">üóëÔ∏è Âà†Èô§</button>
                            <button class="btn-secondary" onclick="editAnswer()">üìÑ ÁºñËæëÁ≠îÊ°à</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÁªüËÆ°ÂàÜÊûêÈ°µÈù¢ -->
            <div id="statistics-page" class="page hidden">
                <h2 class="mb-20">üìä Â≠¶‰π†ÁªüËÆ°</h2>
                
                <!-- ÊÄª‰ΩìÁªüËÆ° -->
                <div class="card mb-20">
                    <h3 class="mb-15">üìà ÊÄª‰ΩìÁªüËÆ°</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="stats-total-questions">0</div>
                            <div class="stat-label">ÊÄªÈ¢òÁõÆÊï∞</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="stats-practiced">0</div>
                            <div class="stat-label">Â∑≤ÁªÉ‰π†</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="stats-accuracy">0%</div>
                            <div class="stat-label">ÊÄªÊ≠£Á°ÆÁéá</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="stats-total-time">0ÂàÜÈíü</div>
                            <div class="stat-label">ÊÄªÁî®Êó∂</div>
                        </div>
                    </div>
                </div>

                <!-- ÊúÄËøëÁªÉ‰π†ËÆ∞ÂΩï -->
                <div class="card">
                    <h3 class="mb-15">üìã ÊúÄËøëÁªÉ‰π†ËÆ∞ÂΩï</h3>
                    <table class="table" id="review-records-table">
                        <thead>
                            <tr>
                                <th>È¢òÁõÆ</th>
                                <th>ÁªìÊûú</th>
                                <th>Áî®Êó∂</th>
                                <th>Êó∂Èó¥</th>
                            </tr>
                        </thead>
                        <tbody id="review-records">
                            <!-- ËÆ∞ÂΩïÂä®ÊÄÅÁîüÊàê -->
                        </tbody>
                    </table>
                    
                    <div class="pagination" id="records-pagination">
                        <!-- ÂàÜÈ°µÊåâÈíÆÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>

            <!-- ËÆæÁΩÆÈ°µÈù¢ -->
            <div id="settings-page" class="page hidden">
                <h2 class="mb-20">‚öôÔ∏è Á≥ªÁªüËÆæÁΩÆ</h2>
                
                <!-- ‰∏ªÈ¢òËÆæÁΩÆ -->
                <div class="card mb-20">
                    <h3 class="mb-15">üé® ‰∏ªÈ¢òËÆæÁΩÆ</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="stat-card" onclick="setTheme('dark')" style="cursor: pointer;">
                            <div style="color: #58A6FF; font-weight: bold;">ÊöóÈªëÁßëÊäÄÈ£é</div>
                            <div style="font-size: 12px; margin-top: 5px;">ÂΩìÂâç‰∏ªÈ¢ò</div>
                        </div>
                        <div class="stat-card" onclick="setTheme('purple')" style="cursor: pointer;">
                            <div style="color: #7209B7; font-weight: bold;">ÊûÅÂÆ¢Á¥´Ëâ≤È£é</div>
                            <div style="font-size: 12px; margin-top: 5px;">ÁÇπÂáªÂàáÊç¢</div>
                        </div>
                        <div class="stat-card" onclick="setTheme('blue')" style="cursor: pointer;">
                            <div style="color: #0969DA; font-weight: bold;">ÁªèÂÖ∏ËìùËâ≤È£é</div>
                            <div style="font-size: 12px; margin-top: 5px;">ÁÇπÂáªÂàáÊç¢</div>
                        </div>
                    </div>
                </div>

                <!-- ËØ≠Èü≥ËÆæÁΩÆ -->
                <div class="card mb-20">
                    <h3 class="mb-15">üîä ËØ≠Èü≥ËÆæÁΩÆ</h3>
                    <div style="display: grid; gap: 15px;">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="enable-tts" checked>
                            <span>ÂêØÁî®ÊñáÂ≠óËΩ¨ËØ≠Èü≥</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="enable-asr" checked>
                            <span>ÂêØÁî®ËØ≠Èü≥ËØÜÂà´</span>
                        </label>
                        <div>
                            <label style="color: #F0F6FC; display: block; margin-bottom: 5px;">ËØ≠Èü≥ÈÄüÂ∫¶:</label>
                            <input type="range" id="speech-rate" min="0.5" max="2" step="0.1" value="1" style="width: 100%;">
                        </div>
                    </div>
                </div>

                <!-- Êï∞ÊçÆÁÆ°ÁêÜ -->
                <div class="card">
                    <h3 class="mb-15">üíæ Êï∞ÊçÆÁÆ°ÁêÜ</h3>
                    <div class="flex gap-15">
                        <button class="btn-secondary" onclick="exportData()">üì§ ÂØºÂá∫Êï∞ÊçÆ</button>
                        <button class="btn-secondary" onclick="importData()">üì• ÂØºÂÖ•Êï∞ÊçÆ</button>
                        <button class="btn-danger" onclick="clearAllData()">üóëÔ∏è Ê∏ÖÁ©∫ÊâÄÊúâÊï∞ÊçÆ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ê®°ÊÄÅÊ°Ü -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Ê†áÈ¢ò</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modal-body">
                <!-- Ê®°ÊÄÅÊ°ÜÂÜÖÂÆπ -->
            </div>
        </div>
    </div>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let questions = [];
        let currentQuestionIndex = 0;
        let isRandomMode = false;
        let reviewRecords = [];
        let sessionStats = {
            correctAnswers: 0,
            totalAnswered: 0,
            startTime: Date.now()
        };
        let selectedQuestionId = null;
        let isRecording = false;
        let speechSynthesis = window.speechSynthesis;
        let speechRecognition = null;

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            initSpeechRecognition();
            loadData();
            initEventListeners();
            showCurrentQuestion();
            updateStats();
            startTimeUpdate();
            
            // Ê∑ªÂä†Á§∫‰æãÊï∞ÊçÆ
            if (questions.length === 0) {
                addSampleQuestions();
            }
        });

        // ÂàùÂßãÂåñËØ≠Èü≥ËØÜÂà´
        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window) {
                speechRecognition = new webkitSpeechRecognition();
                speechRecognition.continuous = false;
                speechRecognition.interimResults = false;
                speechRecognition.lang = 'zh-CN';
                
                speechRecognition.onresult = function(event) {
                    const result = event.results[0][0].transcript;
                    document.getElementById('answer-area').value = result;
                    stopRecording();
                };
                
                speechRecognition.onerror = function(event) {
                    console.error('ËØ≠Èü≥ËØÜÂà´ÈîôËØØ:', event.error);
                    stopRecording();
                    showAlert('ËØ≠Èü≥ËØÜÂà´Â§±Ë¥•', 'ËØ∑Ê£ÄÊü•È∫¶ÂÖãÈ£éÊùÉÈôêÊàñÈáçËØï');
                };
            }
        }

        // Ê∑ªÂä†Á§∫‰æãÊï∞ÊçÆ
        function addSampleQuestions() {
            const sampleQuestions = [
                {
                    id: generateId(),
                    title: "‰ªÄ‰πàÊòØJavaËôöÊãüÊú∫(JVM)Ôºü",
                    content: "ËØ∑ËØ¶ÁªÜËß£ÈáäJavaËôöÊãüÊú∫(JVM)ÁöÑ‰ΩúÁî®„ÄÅÁªÑÊàêÈÉ®ÂàÜ‰ª•ÂèäÂ∑•‰ΩúÂéüÁêÜ„ÄÇÂåÖÊã¨ÂÜÖÂ≠òÁÆ°ÁêÜ„ÄÅÂ≠óËäÇÁ†ÅÊâßË°å„ÄÅÂûÉÂúæÂõûÊî∂Á≠âÊñπÈù¢„ÄÇ",
                    hint: "‰ªéÂÜÖÂ≠òÁÆ°ÁêÜ„ÄÅÂ≠óËäÇÁ†ÅÊâßË°å„ÄÅÂûÉÂúæÂõûÊî∂Á≠âËßíÂ∫¶ËÄÉËôë",
                    answer: "JavaËôöÊãüÊú∫(JVM)ÊòØJavaÁ®ãÂ∫èÁöÑËøêË°åÁéØÂ¢ÉÔºåÂÆÉÁöÑ‰∏ªË¶Å‰ΩúÁî®ÂåÖÊã¨Ôºö\n\n1. **Â≠óËäÇÁ†ÅÊâßË°å**: JVMË¥üË¥£ÊâßË°åJavaÁºñËØëÂô®ÁîüÊàêÁöÑÂ≠óËäÇÁ†ÅÊñá‰ª∂(.class)\n\n2. **ÂÜÖÂ≠òÁÆ°ÁêÜ**: \n   - Â†ÜÂÜÖÂ≠òÔºöÂ≠òÂÇ®ÂØπË±°ÂÆû‰æã\n   - ÊñπÊ≥ïÂå∫ÔºöÂ≠òÂÇ®Á±ª‰ø°ÊÅØ„ÄÅÂ∏∏ÈáèÊ±†\n   - Ê†àÂÜÖÂ≠òÔºöÂ≠òÂÇ®Â±ÄÈÉ®ÂèòÈáèÂíåÊñπÊ≥ïË∞ÉÁî®\n   - PCÂØÑÂ≠òÂô®ÔºöÂ≠òÂÇ®ÂΩìÂâçÊâßË°åÊåá‰ª§ÁöÑÂú∞ÂùÄ\n\n3. **ÂûÉÂúæÂõûÊî∂**: Ëá™Âä®ÂõûÊî∂‰∏çÂÜç‰ΩøÁî®ÁöÑÂØπË±°ÔºåÈáäÊîæÂÜÖÂ≠òÁ©∫Èó¥\n\n4. **Âπ≥Âè∞Êó†ÂÖ≥ÊÄß**: ÂÆûÁé∞'‰∏ÄÊ¨°ÁºñÂÜôÔºåÂà∞Â§ÑËøêË°å'ÁöÑÁâπÊÄß\n\n5. **ÂÆâÂÖ®ÊÄß**: Êèê‰æõÂÆâÂÖ®Ê£ÄÊü•Êú∫Âà∂ÔºåÈò≤Ê≠¢ÊÅ∂ÊÑè‰ª£Á†ÅÊâßË°å",
                    category: "JavaÂü∫Á°Ä",
                    difficulty: "MEDIUM",
                    createdAt: new Date().toISOString()
                },
                {
                    id: generateId(),
                    title: "Spring BootÁöÑËá™Âä®ÈÖçÁΩÆÂéüÁêÜ",
                    content: "Spring BootÊòØÂ¶Ç‰ΩïÂÆûÁé∞Ëá™Âä®ÈÖçÁΩÆÁöÑÔºüËØ∑‰ªéÊ∫êÁ†ÅËßíÂ∫¶ÂàÜÊûê@EnableAutoConfigurationÊ≥®Ëß£ÁöÑÂ∑•‰ΩúÊú∫Âà∂„ÄÇ",
                    hint: "ËÄÉËôë@EnableAutoConfigurationÊ≥®Ëß£Âíåspring.factoriesÊñá‰ª∂ÁöÑ‰ΩúÁî®",
                    answer: "Spring BootËá™Âä®ÈÖçÁΩÆÂéüÁêÜÔºö\n\n1. **@EnableAutoConfigurationÊ≥®Ëß£**:\n   - ÈÄöËøá@Import(AutoConfigurationImportSelector.class)ÂØºÂÖ•ÈÖçÁΩÆ\n   - AutoConfigurationImportSelectorËØªÂèñMETA-INF/spring.factoriesÊñá‰ª∂\n\n2. **spring.factoriesÊñá‰ª∂**:\n   - ÂÆö‰πâ‰∫ÜÊâÄÊúâÁöÑËá™Âä®ÈÖçÁΩÆÁ±ª\n   - Ê†ºÂºèÔºöorg.springframework.boot.autoconfigure.EnableAutoConfiguration=ÈÖçÁΩÆÁ±ªÂàóË°®\n\n3. **Ëá™Âä®ÈÖçÁΩÆÁ±ªÁâπÁÇπ**:\n   - ‰ΩøÁî®@ConfigurationÊ≥®Ëß£\n   - ‰ΩøÁî®@ConditionalOnXxxÊ≥®Ëß£ËøõË°åÊù°‰ª∂Âà§Êñ≠\n   - Âè™ÊúâÊª°Ë∂≥Êù°‰ª∂Êâç‰ºöÁîüÊïà\n\n4. **Â∏∏ËßÅÁöÑÊù°‰ª∂Ê≥®Ëß£**:\n   - @ConditionalOnClassÔºöÁ±ªË∑ØÂæÑÂ≠òÂú®Êüê‰∏™Á±ª\n   - @ConditionalOnMissingBeanÔºöÂÆπÂô®‰∏≠‰∏çÂ≠òÂú®Êüê‰∏™Bean\n   - @ConditionalOnPropertyÔºöÈÖçÁΩÆÂ±ûÊÄßÊª°Ë∂≥Êù°‰ª∂\n\n5. **ÈÖçÁΩÆ‰ºòÂÖàÁ∫ß**:\n   - Áî®Êà∑Ëá™ÂÆö‰πâÈÖçÁΩÆ > Ëá™Âä®ÈÖçÁΩÆ",
                    category: "SpringÊ°ÜÊû∂",
                    difficulty: "HARD",
                    createdAt: new Date().toISOString()
                },
                {
                    id: generateId(),
                    title: "MySQLÁöÑACIDÁâπÊÄß",
                    content: "ËØ∑ËØ¶ÁªÜËß£ÈáäÊï∞ÊçÆÂ∫ì‰∫ãÂä°ÁöÑACIDÁâπÊÄßÔºåÂπ∂‰∏æ‰æãËØ¥ÊòéÊØè‰∏™ÁâπÊÄßÁöÑÈáçË¶ÅÊÄß„ÄÇ",
                    hint: "ÂéüÂ≠êÊÄß„ÄÅ‰∏ÄËá¥ÊÄß„ÄÅÈöîÁ¶ªÊÄß„ÄÅÊåÅ‰πÖÊÄß",
                    answer: "MySQLÁöÑACIDÁâπÊÄßÔºö\n\n1. **ÂéüÂ≠êÊÄß(Atomicity)**:\n   - ‰∫ãÂä°ÊòØ‰∏çÂèØÂàÜÂâ≤ÁöÑÊúÄÂ∞èÂ∑•‰ΩúÂçï‰Ωç\n   - Ë¶Å‰πàÂÖ®ÈÉ®ÊàêÂäüÔºåË¶Å‰πàÂÖ®ÈÉ®Â§±Ë¥•ÂõûÊªö\n   - ‰æãÔºöËΩ¨Ë¥¶Êìç‰ΩúÔºåÊâ£Ê¨æÂíåÂÖ•Ë¥¶ÂøÖÈ°ªÂêåÊó∂ÊàêÂäüÊàñÂ§±Ë¥•\n\n2. **‰∏ÄËá¥ÊÄß(Consistency)**:\n   - ‰∫ãÂä°ÊâßË°åÂâçÂêéÔºåÊï∞ÊçÆÂ∫ì‰ªé‰∏Ä‰∏™‰∏ÄËá¥ÊÄßÁä∂ÊÄÅËΩ¨Êç¢Âà∞Âè¶‰∏Ä‰∏™‰∏ÄËá¥ÊÄßÁä∂ÊÄÅ\n   - ‰æãÔºöËΩ¨Ë¥¶ÂâçÂêéÔºå‰∏§‰∏™Ë¥¶Êà∑‰ΩôÈ¢ùÊÄªÂíå‰∏çÂèò\n\n3. **ÈöîÁ¶ªÊÄß(Isolation)**:\n   - Âπ∂ÂèëÊâßË°åÁöÑ‰∫ãÂä°‰πãÈó¥‰∏çËÉΩÁõ∏‰∫íÂπ≤Êâ∞\n   - ÈÄöËøáÈîÅÊú∫Âà∂ÂíåMVCCÂÆûÁé∞\n   - ÈöîÁ¶ªÁ∫ßÂà´ÔºöËØªÊú™Êèê‰∫§„ÄÅËØªÂ∑≤Êèê‰∫§„ÄÅÂèØÈáçÂ§çËØª„ÄÅ‰∏≤Ë°åÂåñ\n\n4. **ÊåÅ‰πÖÊÄß(Durability)**:\n   - ‰∫ãÂä°‰∏ÄÊó¶Êèê‰∫§ÔºåÂØπÊï∞ÊçÆÁöÑ‰øÆÊîπÂ∞±ÊòØÊ∞∏‰πÖÁöÑ\n   - ÈÄöËøáredo logÁ°Æ‰øùÂç≥‰ΩøÁ≥ªÁªüÂ¥©Ê∫É‰πüËÉΩÊÅ¢Â§ç\n\n**ÂÆûÁé∞Êú∫Âà∂**:\n- undo log‰øùËØÅÂéüÂ≠êÊÄßÂíå‰∏ÄËá¥ÊÄß\n- ÈîÅÊú∫Âà∂ÂíåMVCC‰øùËØÅÈöîÁ¶ªÊÄß\n- redo log‰øùËØÅÊåÅ‰πÖÊÄß",
                    category: "Êï∞ÊçÆÂ∫ì",
                    difficulty: "MEDIUM",
                    createdAt: new Date().toISOString()
                },
                {
                    id: generateId(),
                    title: "HashMap vs ConcurrentHashMap",
                    content: "ËØ∑ÂØπÊØîHashMapÂíåConcurrentHashMapÁöÑÂÆûÁé∞ÂéüÁêÜ„ÄÅÊï∞ÊçÆÁªìÊûÑÂíå‰ΩøÁî®Âú∫ÊôØÔºåÂàÜÊûêÂÆÉ‰ª¨Âú®Á∫øÁ®ãÂÆâÂÖ®ÊñπÈù¢ÁöÑÂ∑ÆÂºÇ„ÄÇ",
                    hint: "Á∫øÁ®ãÂÆâÂÖ®„ÄÅÊï∞ÊçÆÁªìÊûÑ„ÄÅÊÄßËÉΩÂ∑ÆÂºÇ",
                    answer: "HashMap vs ConcurrentHashMapÂØπÊØîÔºö\n\n**HashMap**:\n1. **Á∫øÁ®ãÂÆâÂÖ®ÊÄß**: ÈùûÁ∫øÁ®ãÂÆâÂÖ®\n2. **Êï∞ÊçÆÁªìÊûÑ**: Êï∞ÁªÑ+ÈìæË°®+Á∫¢ÈªëÊ†ë(JDK8+)\n3. **ÊÄßËÉΩ**: ÂçïÁ∫øÁ®ãÁéØÂ¢É‰∏ãÊÄßËÉΩÊúÄ‰ºò\n4. **Êâ©ÂÆπ**: ÈùûÁ∫øÁ®ãÂÆâÂÖ®ÔºåÂèØËÉΩÂØºËá¥Ê≠ªÂæ™ÁéØ\n\n**ConcurrentHashMap**:\n1. **Á∫øÁ®ãÂÆâÂÖ®ÊÄß**: Á∫øÁ®ãÂÆâÂÖ®\n2. **ÂÆûÁé∞ÂéüÁêÜ**:\n   - JDK7: ÂàÜÊÆµÈîÅ(Segment)\n   - JDK8: CAS + synchronized\n3. **Êï∞ÊçÆÁªìÊûÑ**: ‰∏éHashMapÁ±ª‰ººÔºå‰ΩÜÂä†ÂÖ•‰∫ÜÂπ∂ÂèëÊéßÂà∂\n4. **Êâ©ÂÆπ**: ÊîØÊåÅÂπ∂ÂèëÊâ©ÂÆπÔºåÂ§öÁ∫øÁ®ãÂçèÂä©ËøÅÁßª\n\n**‰∏ªË¶ÅÂå∫Âà´**:\n1. **ÈîÅÁ≤íÂ∫¶**: ConcurrentHashMapÈîÅÁ≤íÂ∫¶Êõ¥ÁªÜ\n2. **ÊÄßËÉΩ**: \n   - ÂçïÁ∫øÁ®ã: HashMap > ConcurrentHashMap\n   - Â§öÁ∫øÁ®ã: ConcurrentHashMap > HashMap\n3. **‰ΩøÁî®Âú∫ÊôØ**:\n   - HashMap: ÂçïÁ∫øÁ®ãÊàñÊòéÁ°ÆÊó†Âπ∂ÂèëËÆøÈóÆ\n   - ConcurrentHashMap: Â§öÁ∫øÁ®ãÂπ∂ÂèëËÆøÈóÆ\n\n**ConcurrentHashMap‰ºòÂåñ**:\n- ËØªÊìç‰ΩúÂá†‰πéÊó†ÈîÅ\n- ÂÜôÊìç‰Ωú‰ΩøÁî®CASÂíåÂ±ÄÈÉ®ÈîÅ\n- ÊîØÊåÅÂπ∂ÂèëÊâ©ÂÆπ",
                    category: "JavaÈõÜÂêà",
                    difficulty: "HARD",
                    createdAt: new Date().toISOString()
                },
                {
                    id: generateId(),
                    title: "RedisÊåÅ‰πÖÂåñÊú∫Âà∂",
                    content: "RedisÊúâÂì™‰∫õÊåÅ‰πÖÂåñÊñπÂºèÔºüËØ∑ËØ¶ÁªÜËØ¥ÊòéRDBÂíåAOFÁöÑÂ∑•‰ΩúÂéüÁêÜ„ÄÅ‰ºòÁº∫ÁÇπÂíåÈÄÇÁî®Âú∫ÊôØ„ÄÇ",
                    hint: "RDBÂíåAOF‰∏§ÁßçÊñπÂºèÔºåËÄÉËôëÊÄßËÉΩÂíåÊï∞ÊçÆÂÆâÂÖ®ÊÄß",
                    answer: "RedisÊåÅ‰πÖÂåñÊú∫Âà∂Ôºö\n\n**1. RDB(Redis Database)**:\n- **ÂéüÁêÜ**: Âú®ÊåáÂÆöÊó∂Èó¥Èó¥ÈöîÂÜÖÁîüÊàêÊï∞ÊçÆÈõÜÁöÑÊó∂Èó¥ÁÇπÂø´ÁÖß\n- **Ëß¶ÂèëÊñπÂºè**:\n  - ÊâãÂä®: SAVE„ÄÅBGSAVEÂëΩ‰ª§\n  - Ëá™Âä®: ÈÖçÁΩÆsaveËßÑÂàô\n- **‰ºòÁÇπ**:\n  - Êñá‰ª∂Á¥ßÂáëÔºåÈÄÇÂêàÂ§á‰ªΩ\n  - ÊÅ¢Â§çÈÄüÂ∫¶Âø´\n  - ÂØπÊÄßËÉΩÂΩ±ÂìçÂ∞è\n- **Áº∫ÁÇπ**:\n  - Êï∞ÊçÆ‰∏¢Â§±È£éÈô©Â§ß\n  - forkÂ≠êËøõÁ®ãÊó∂‰ºöÈòªÂ°û\n\n**2. AOF(Append Only File)**:\n- **ÂéüÁêÜ**: ËÆ∞ÂΩïÊØè‰∏™ÂÜôÊìç‰ΩúÂëΩ‰ª§\n- **ÂêåÊ≠•Á≠ñÁï•**:\n  - always: ÊØè‰∏™ÂëΩ‰ª§ÈÉΩÂêåÊ≠•\n  - everysec: ÊØèÁßíÂêåÊ≠•‰∏ÄÊ¨°\n  - no: Áî±Êìç‰ΩúÁ≥ªÁªüÂÜ≥ÂÆö\n- **‰ºòÁÇπ**:\n  - Êï∞ÊçÆÂÆâÂÖ®ÊÄßÈ´ò\n  - Êñá‰ª∂ÂèØËØªÔºå‰æø‰∫éÁêÜËß£\n  - ÊîØÊåÅÈáçÂÜôÂéãÁº©\n- **Áº∫ÁÇπ**:\n  - Êñá‰ª∂‰ΩìÁßØÂ§ß\n  - ÊÅ¢Â§çÈÄüÂ∫¶ÊÖ¢\n  - ÊÄßËÉΩÂºÄÈîÄÂ§ß\n\n**3. Ê∑∑ÂêàÊåÅ‰πÖÂåñ(Redis 4.0+)**:\n- ÁªìÂêàRDBÂíåAOFÁöÑ‰ºòÁÇπ\n- AOFÈáçÂÜôÊó∂‰ΩøÁî®RDBÊ†ºÂºèÂÜôÂÖ•\n- ÂÖºÈ°æÊÄßËÉΩÂíåÊï∞ÊçÆÂÆâÂÖ®\n\n**ÈÄâÊã©Âª∫ËÆÆ**:\n- È´òÊÄßËÉΩË¶ÅÊ±Ç: RDB\n- È´òÊï∞ÊçÆÂÆâÂÖ®: AOF\n- Âπ≥Ë°°ËÄÉËôë: Ê∑∑ÂêàÊåÅ‰πÖÂåñ",
                    category: "Redis",
                    difficulty: "MEDIUM",
                    createdAt: new Date().toISOString()
                }
            ];

            questions = sampleQuestions;
            saveData();
            updateQuestionList();
            showCurrentQuestion();
        }

        // ÂàùÂßãÂåñ‰∫ã‰ª∂ÁõëÂê¨Âô®
        function initEventListeners() {
            // ÂØºËà™ÊåâÈíÆ
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.addEventListener('click', function() {
                    const page = this.dataset.page;
                    showPage(page);
                    
                    // Êõ¥Êñ∞Ê¥ªÂä®Áä∂ÊÄÅ
                    document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // ÈîÆÁõòÂø´Êç∑ÈîÆ
            document.addEventListener('keydown', function(e) {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    return;
                }

                switch(e.code) {
                    case 'Space':
                        e.preventDefault();
                        toggleVoiceRecording();
                        break;
                    case 'Enter':
                        e.preventDefault();
                        submitAnswer();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        nextQuestion();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        previousQuestion();
                        break;
                }
            });

            // Á≠îÊ°àÂå∫ÂüüÂõûËΩ¶Êèê‰∫§
            document.getElementById('answer-area').addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    e.preventDefault();
                    submitAnswer();
                }
            });
        }

        // È°µÈù¢ÂàáÊç¢
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            const targetPage = document.getElementById(pageName + '-page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                targetPage.classList.add('fade-in');
                
                // ÁâπÂÆöÈ°µÈù¢ÁöÑÂàùÂßãÂåñ
                if (pageName === 'manage') {
                    updateQuestionList();
                } else if (pageName === 'statistics') {
                    updateStatistics();
                }
            }
        }

        // Êï∞ÊçÆÊìç‰Ωú
        function loadData() {
            const savedQuestions = localStorage.getItem('baguwen_questions');
            const savedRecords = localStorage.getItem('baguwen_records');
            
            if (savedQuestions) {
                questions = JSON.parse(savedQuestions);
            }
            
            if (savedRecords) {
                reviewRecords = JSON.parse(savedRecords);
            }
        }

        function saveData() {
            localStorage.setItem('baguwen_questions', JSON.stringify(questions));
            localStorage.setItem('baguwen_records', JSON.stringify(reviewRecords));
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // Â§ç‰π†ÂäüËÉΩ
        function showCurrentQuestion() {
            if (questions.length === 0) {
                document.getElementById('question-text').textContent = 'ÊöÇÊó†È¢òÁõÆÔºåËØ∑ÂÖàÊ∑ªÂä†‰∏Ä‰∫õÈ¢òÁõÆÂºÄÂßãÂ§ç‰π†„ÄÇ';
                document.getElementById('progress-text').textContent = 'È¢òÁõÆ 0 / 0';
                document.getElementById('progress-bar').style.width = '0%';
                return;
            }

            if (currentQuestionIndex >= questions.length) {
                currentQuestionIndex = 0;
            }

            const current = questions[currentQuestionIndex];
            document.getElementById('question-text').textContent = current.content;
            document.getElementById('progress-text').textContent = `È¢òÁõÆ ${currentQuestionIndex + 1} / ${questions.length}`;
            document.getElementById('progress-bar').style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;
            
            // Ê∏ÖÁ©∫Á≠îÊ°à
            document.getElementById('answer-area').value = '';
            
            // Ê∑ªÂä†Âä®ÁîªÊïàÊûú
            const questionElement = document.getElementById('question-text');
            questionElement.style.opacity = '0';
            setTimeout(() => {
                questionElement.style.opacity = '1';
            }, 100);
        }

        function nextQuestion() {
            if (questions.length === 0) return;
            
            if (isRandomMode) {
                currentQuestionIndex = Math.floor(Math.random() * questions.length);
            } else {
                currentQuestionIndex = (currentQuestionIndex + 1) % questions.length;
            }
            showCurrentQuestion();
        }

        function previousQuestion() {
            if (questions.length === 0) return;
            
            if (isRandomMode) {
                currentQuestionIndex = Math.floor(Math.random() * questions.length);
            } else {
                currentQuestionIndex = currentQuestionIndex > 0 ? currentQuestionIndex - 1 : questions.length - 1;
            }
            showCurrentQuestion();
        }

        function toggleMode() {
            isRandomMode = !isRandomMode;
            const modeBtn = document.getElementById('mode-btn');
            modeBtn.textContent = isRandomMode ? 'üîÄ ÈöèÊú∫' : 'üìë È°∫Â∫è';
            
            // Âä®ÁîªÊïàÊûú
            modeBtn.style.transform = 'scale(1.1)';
            setTimeout(() => {
                modeBtn.style.transform = 'scale(1)';
            }, 200);
        }

        function submitAnswer() {
            const answerText = document.getElementById('answer-area').value.trim();
            if (!answerText) {
                showAlert('ÊèêÁ§∫', 'ËØ∑ÂÖàËæìÂÖ•Á≠îÊ°àÔºÅ');
                return;
            }

            if (questions.length === 0) return;

            // ÂºπÂá∫Á°ÆËÆ§ÂØπËØùÊ°Ü
            const isCorrect = confirm('ËØ∑Á°ÆËÆ§ÊÇ®ÁöÑÁ≠îÊ°àÊòØÂê¶Ê≠£Á°ÆÔºü\n\nÁÇπÂáª"Á°ÆÂÆö"Ë°®Á§∫Ê≠£Á°ÆÔºå"ÂèñÊ∂à"Ë°®Á§∫ÈîôËØØ„ÄÇ');
            
            // ËÆ∞ÂΩïÁ≠îÈ¢òÁªìÊûú
            recordAnswer(answerText, isCorrect);
            
            if (isCorrect) {
                sessionStats.correctAnswers++;
                // Âä®ÁîªÊïàÊûú
                const correctCountElement = document.getElementById('correct-count');
                correctCountElement.style.transform = 'scale(1.2)';
                correctCountElement.style.color = '#3FB950';
                setTimeout(() => {
                    correctCountElement.style.transform = 'scale(1)';
                    correctCountElement.style.color = '#58A6FF';
                }, 300);
            }
            
            sessionStats.totalAnswered++;
            updateStats();
        }

        function recordAnswer(answerText, isCorrect) {
            if (questions.length === 0) return;
            
            const current = questions[currentQuestionIndex];
            const record = {
                id: generateId(),
                questionId: current.id,
                questionTitle: current.title,
                userAnswer: answerText,
                isCorrect: isCorrect,
                reviewTime: new Date().toLocaleString(),
                timeSpent: Math.floor((Date.now() - sessionStats.startTime) / 1000)
            };
            
            reviewRecords.unshift(record);
            
            // Âè™‰øùÁïôÊúÄËøë1000Êù°ËÆ∞ÂΩï
            if (reviewRecords.length > 1000) {
                reviewRecords = reviewRecords.slice(0, 1000);
            }
            
            saveData();
        }

        function showAnswer() {
            if (questions.length === 0) return;
            
            const current = questions[currentQuestionIndex];
            showModal('Ê†áÂáÜÁ≠îÊ°à - ' + current.title, `<div style="white-space: pre-line; line-height: 1.6;">${current.answer}</div>`);
        }

        function showHint() {
            if (questions.length === 0) return;
            
            const current = questions[currentQuestionIndex];
            if (current.hint) {
                showAlert('üí° ÊèêÁ§∫', current.hint);
            } else {
                showAlert('ÊèêÁ§∫', 'ËØ•È¢òÁõÆÊöÇÊó†ÊèêÁ§∫„ÄÇ');
            }
        }

        function readQuestion() {
            if (questions.length === 0) return;
            
            const current = questions[currentQuestionIndex];
            speakText(current.content);
        }

        function focusAnswerArea() {
            document.getElementById('answer-area').focus();
        }

        // ËØ≠Èü≥ÂäüËÉΩ
        function toggleVoiceRecording() {
            if (!speechRecognition) {
                showAlert('‰∏çÊîØÊåÅ', 'ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ËØÜÂà´ÂäüËÉΩ');
                return;
            }

            if (!document.getElementById('enable-asr').checked) {
                showAlert('ÊèêÁ§∫', 'ËØ≠Èü≥ËØÜÂà´ÂäüËÉΩÂ∑≤Á¶ÅÁî®ÔºåËØ∑Âú®ËÆæÁΩÆ‰∏≠ÂêØÁî®');
                return;
            }

            if (isRecording) {
                stopRecording();
            } else {
                startRecording();
            }
        }

        function startRecording() {
            const voiceBtn = document.getElementById('voice-btn');
            voiceBtn.classList.add('recording');
            voiceBtn.textContent = 'üéôÔ∏è';
            isRecording = true;
            
            try {
                speechRecognition.start();
            } catch (error) {
                console.error('ÂêØÂä®ËØ≠Èü≥ËØÜÂà´Â§±Ë¥•:', error);
                stopRecording();
            }
        }

        function stopRecording() {
            const voiceBtn = document.getElementById('voice-btn');
            voiceBtn.classList.remove('recording');
            voiceBtn.textContent = 'üé§';
            isRecording = false;
            
            if (speechRecognition) {
                speechRecognition.stop();
            }
        }

        function speakText(text) {
            if (!document.getElementById('enable-tts').checked) {
                showAlert('ÊèêÁ§∫', 'ËØ≠Èü≥ÊúóËØªÂäüËÉΩÂ∑≤Á¶ÅÁî®ÔºåËØ∑Âú®ËÆæÁΩÆ‰∏≠ÂêØÁî®');
                return;
            }

            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
                return;
            }

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN';
            utterance.rate = parseFloat(document.getElementById('speech-rate').value);
            
            speechSynthesis.speak(utterance);
        }

        // È¢òÁõÆÁÆ°ÁêÜ
        function updateQuestionList() {
            const listElement = document.getElementById('question-list');
            listElement.innerHTML = '';
            
            questions.forEach(question => {
                const item = document.createElement('div');
                item.className = 'question-item';
                item.onclick = () => selectQuestion(question.id);
                
                if (selectedQuestionId === question.id) {
                    item.classList.add('selected');
                }
                
                item.innerHTML = `
                    <div class="question-title">${question.title}</div>
                    <div class="question-meta">${question.category || 'Êú™ÂàÜÁ±ª'} | ${getDifficultyText(question.difficulty)} | ${new Date(question.createdAt).toLocaleDateString()}</div>
                `;
                
                listElement.appendChild(item);
            });
        }

        function selectQuestion(questionId) {
            selectedQuestionId = questionId;
            const question = questions.find(q => q.id === questionId);
            
            if (question) {
                document.getElementById('question-title').value = question.title;
                document.getElementById('question-content').value = question.content;
                document.getElementById('question-hint').value = question.hint || '';
                document.getElementById('question-category').value = question.category || '';
                document.getElementById('question-difficulty').value = question.difficulty;
            }
            
            updateQuestionList();
        }

        function addNewQuestion() {
            selectedQuestionId = null;
            document.getElementById('question-title').value = '';
            document.getElementById('question-content').value = '';
            document.getElementById('question-hint').value = '';
            document.getElementById('question-category').value = '';
            document.getElementById('question-difficulty').value = 'MEDIUM';
            document.getElementById('question-title').focus();
            updateQuestionList();
        }

        function saveQuestion() {
            const title = document.getElementById('question-title').value.trim();
            const content = document.getElementById('question-content').value.trim();
            const hint = document.getElementById('question-hint').value.trim();
            const category = document.getElementById('question-category').value.trim();
            const difficulty = document.getElementById('question-difficulty').value;
            
            if (!title || !content) {
                showAlert('ÈîôËØØ', 'È¢òÁõÆÊ†áÈ¢òÂíåÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫ÔºÅ');
                return;
            }
            
            if (selectedQuestionId) {
                // Êõ¥Êñ∞Áé∞ÊúâÈ¢òÁõÆ
                const questionIndex = questions.findIndex(q => q.id === selectedQuestionId);
                if (questionIndex !== -1) {
                    questions[questionIndex] = {
                        ...questions[questionIndex],
                        title,
                        content,
                        hint,
                        category,
                        difficulty,
                        updatedAt: new Date().toISOString()
                    };
                }
            } else {
                // Ê∑ªÂä†Êñ∞È¢òÁõÆ
                const newQuestion = {
                    id: generateId(),
                    title,
                    content,
                    hint,
                    answer: `ËøôÈáåÊòØ "${title}" ÁöÑÊ†áÂáÜÁ≠îÊ°à„ÄÇ\n\nËØ∑ÁºñËæëÊ≠§Á≠îÊ°àÂÜÖÂÆπ...`,
                    category,
                    difficulty,
                    createdAt: new Date().toISOString()
                };
                questions.unshift(newQuestion);
                selectedQuestionId = newQuestion.id;
            }
            
            saveData();
            updateQuestionList();
            showAlert('ÊàêÂäü', 'È¢òÁõÆ‰øùÂ≠òÊàêÂäüÔºÅ');
            
            // Â¶ÇÊûúÂΩìÂâçÂú®Â§ç‰π†È°µÈù¢ÔºåÊõ¥Êñ∞È¢òÁõÆÊòæÁ§∫
            if (!document.getElementById('review-page').classList.contains('hidden')) {
                showCurrentQuestion();
            }
        }

        function deleteQuestion() {
            if (!selectedQuestionId) {
                showAlert('ÊèêÁ§∫', 'ËØ∑ÂÖàÈÄâÊã©Ë¶ÅÂà†Èô§ÁöÑÈ¢òÁõÆÔºÅ');
                return;
            }
            
            const question = questions.find(q => q.id === selectedQuestionId);
            if (!question) return;
            
            if (confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§È¢òÁõÆ "${question.title}" ÂêóÔºü`)) {
                questions = questions.filter(q => q.id !== selectedQuestionId);
                reviewRecords = reviewRecords.filter(r => r.questionId !== selectedQuestionId);
                
                saveData();
                addNewQuestion();
                showAlert('ÊàêÂäü', 'È¢òÁõÆÂà†Èô§ÊàêÂäüÔºÅ');
                
                // Â¶ÇÊûúÂΩìÂâçÈ¢òÁõÆË¢´Âà†Èô§ÔºåÈáçÁΩÆÁ¥¢Âºï
                if (currentQuestionIndex >= questions.length) {
                    currentQuestionIndex = 0;
                }
                showCurrentQuestion();
            }
        }

        function editAnswer() {
            if (!selectedQuestionId) {
                showAlert('ÊèêÁ§∫', 'ËØ∑ÂÖàÈÄâÊã©È¢òÁõÆÔºÅ');
                return;
            }
            
            const question = questions.find(q => q.id === selectedQuestionId);
            if (!question) return;
            
            const newAnswer = prompt('ËØ∑ÁºñËæëÁ≠îÊ°à:', question.answer);
            if (newAnswer !== null) {
                question.answer = newAnswer;
                saveData();
                showAlert('ÊàêÂäü', 'Á≠îÊ°à‰øùÂ≠òÊàêÂäüÔºÅ');
            }
        }

        // ÁªüËÆ°ÂäüËÉΩ
        function updateStats() {
            // Â§ç‰π†È°µÈù¢ÁªüËÆ°
            document.getElementById('correct-count').textContent = sessionStats.correctAnswers;
            document.getElementById('total-count').textContent = sessionStats.totalAnswered;
            
            const accuracy = sessionStats.totalAnswered > 0 ? 
                (sessionStats.correctAnswers / sessionStats.totalAnswered * 100).toFixed(1) : 0;
            document.getElementById('accuracy-rate').textContent = accuracy + '%';
        }

        function updateStatistics() {
            // ÊÄª‰ΩìÁªüËÆ°
            document.getElementById('stats-total-questions').textContent = questions.length;
            
            const practicedQuestions = new Set(reviewRecords.map(r => r.questionId)).size;
            document.getElementById('stats-practiced').textContent = practicedQuestions;
            
            const totalCorrect = reviewRecords.filter(r => r.isCorrect).length;
            const totalReviews = reviewRecords.length;
            const overallAccuracy = totalReviews > 0 ? (totalCorrect / totalReviews * 100).toFixed(1) : 0;
            document.getElementById('stats-accuracy').textContent = overallAccuracy + '%';
            
            const totalTime = reviewRecords.reduce((sum, r) => sum + (r.timeSpent || 0), 0);
            document.getElementById('stats-total-time').textContent = Math.floor(totalTime / 60) + 'ÂàÜÈíü';
            
            // Êõ¥Êñ∞ËÆ∞ÂΩïË°®
            updateRecordsTable();
        }

        function updateRecordsTable() {
            const tbody = document.getElementById('review-records');
            tbody.innerHTML = '';
            
            const recentRecords = reviewRecords.slice(0, 20);
            
            recentRecords.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${record.questionTitle}">${record.questionTitle}</td>
                    <td>${record.isCorrect ? '‚úÖ Ê≠£Á°Æ' : '‚ùå ÈîôËØØ'}</td>
                    <td>${record.timeSpent}Áßí</td>
                    <td>${record.reviewTime}</td>
                `;
                tbody.appendChild(row);
            });
            
            if (recentRecords.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="4" style="text-align: center; color: #7D8590;">ÊöÇÊó†ÁªÉ‰π†ËÆ∞ÂΩï</td>';
                tbody.appendChild(row);
            }
        }

        function startTimeUpdate() {
            setInterval(() => {
                const elapsed = Math.floor((Date.now() - sessionStats.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('time-spent').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // ËÆæÁΩÆÂäüËÉΩ
        function setTheme(themeName) {
            // ËøôÈáåÂèØ‰ª•ÂÆûÁé∞‰∏ªÈ¢òÂàáÊç¢ÈÄªËæë
            showAlert('‰∏ªÈ¢ò', `Â∑≤ÂàáÊç¢Âà∞${getThemeName(themeName)}‰∏ªÈ¢ò`);
        }

        function getThemeName(theme) {
            const themes = {
                'dark': 'ÊöóÈªëÁßëÊäÄÈ£é',
                'purple': 'ÊûÅÂÆ¢Á¥´Ëâ≤È£é',
                'blue': 'ÁªèÂÖ∏ËìùËâ≤È£é'
            };
            return themes[theme] || 'Êú™Áü•‰∏ªÈ¢ò';
        }

        function exportData() {
            const data = {
                questions: questions,
                records: reviewRecords,
                exportTime: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `baguwen_data_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            showAlert('ÊàêÂäü', 'Êï∞ÊçÆÂØºÂá∫ÊàêÂäüÔºÅ');
        }

                function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const data = JSON.parse(event.target.result);
                        
                        if (data.questions && Array.isArray(data.questions)) {
                            if (confirm('Á°ÆÂÆöË¶ÅÂØºÂÖ•Êï∞ÊçÆÂêóÔºüËøôÂ∞ÜË¶ÜÁõñÁé∞ÊúâÊï∞ÊçÆÔºÅ')) {
                                questions = data.questions;
                                if (data.records && Array.isArray(data.records)) {
                                    reviewRecords = data.records;
                                }
                                
                                saveData();
                                updateQuestionList();
                                showCurrentQuestion();
                                updateStatistics();
                                showAlert('ÊàêÂäü', 'Êï∞ÊçÆÂØºÂÖ•ÊàêÂäüÔºÅ');
                            }
                        } else {
                            showAlert('ÈîôËØØ', 'Êó†ÊïàÁöÑÊï∞ÊçÆÊ†ºÂºèÔºÅ');
                        }
                    } catch (error) {
                        showAlert('ÈîôËØØ', 'Êñá‰ª∂Ê†ºÂºèÈîôËØØÔºö' + error.message);
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }

        function clearAllData() {
            if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÊï∞ÊçÆÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§çÔºÅ')) {
                questions = [];
                reviewRecords = [];
                sessionStats = {
                    correctAnswers: 0,
                    totalAnswered: 0,
                    startTime: Date.now()
                };
                
                localStorage.removeItem('baguwen_questions');
                localStorage.removeItem('baguwen_records');
                
                currentQuestionIndex = 0;
                selectedQuestionId = null;
                
                updateQuestionList();
                showCurrentQuestion();
                updateStats();
                updateStatistics();
                
                showAlert('ÊàêÂäü', 'ÊâÄÊúâÊï∞ÊçÆÂ∑≤Ê∏ÖÁ©∫ÔºÅ');
            }
        }

        // Â∑•ÂÖ∑ÂáΩÊï∞
        function getDifficultyText(difficulty) {
            const difficultyMap = {
                'EASY': 'ÁÆÄÂçï',
                'MEDIUM': '‰∏≠Á≠â',
                'HARD': 'Âõ∞Èöæ'
            };
            return difficultyMap[difficulty] || 'Êú™Áü•';
        }

        function showAlert(title, message) {
            alert(`${title}Ôºö${message}`);
        }

        function showModal(title, content) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-body').innerHTML = content;
            document.getElementById('modal').style.display = 'flex';
            
            // Ê∑ªÂä†Ê∑°ÂÖ•Âä®Áîª
            const modal = document.getElementById('modal');
            modal.style.opacity = '0';
            setTimeout(() => {
                modal.style.opacity = '1';
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.style.opacity = '0';
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }

        // ÁÇπÂáªÊ®°ÊÄÅÊ°ÜËÉåÊôØÂÖ≥Èó≠
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // ESCÈîÆÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && document.getElementById('modal').style.display === 'flex') {
                closeModal();
            }
        });

        // Èò≤Ê≠¢È°µÈù¢Âà∑Êñ∞‰∏¢Â§±Êï∞ÊçÆÁöÑÊèêÈÜí
        window.addEventListener('beforeunload', function(e) {
            if (sessionStats.totalAnswered > 0) {
                e.preventDefault();
                e.returnValue = 'ÊÇ®ÊúâÊú™‰øùÂ≠òÁöÑÂ§ç‰π†ËÆ∞ÂΩïÔºåÁ°ÆÂÆöË¶ÅÁ¶ªÂºÄÂêóÔºü';
            }
        });

        // ÁßªÂä®Á´ØÊîØÊåÅ
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // ÂêëÂ∑¶ÊªëÂä® - ‰∏ã‰∏ÄÈ¢ò
                    nextQuestion();
                } else {
                    // ÂêëÂè≥ÊªëÂä® - ‰∏ä‰∏ÄÈ¢ò
                    previousQuestion();
                }
            }
        }

        // Ëá™Âä®‰øùÂ≠òÂäüËÉΩ
        setInterval(function() {
            saveData();
        }, 30000); // ÊØè30ÁßíËá™Âä®‰øùÂ≠ò‰∏ÄÊ¨°

        // ‰∏ªÈ¢òÂàáÊç¢ÂÆåÊï¥ÂÆûÁé∞
        function setTheme(themeName) {
            const themes = {
                'dark': {
                    name: 'ÊöóÈªëÁßëÊäÄÈ£é',
                    primary: '#58A6FF',
                    secondary: '#7C3AED',
                    background: '#0D1117',
                    cardBg: '#161B22',
                    textColor: '#F0F6FC'
                },
                'purple': {
                    name: 'ÊûÅÂÆ¢Á¥´Ëâ≤È£é',
                    primary: '#7209B7',
                    secondary: '#9D4EDD',
                    background: '#1A0B2E',
                    cardBg: '#16213E',
                    textColor: '#EAEAEA'
                },
                'blue': {
                    name: 'ÁªèÂÖ∏ËìùËâ≤È£é',
                    primary: '#0969DA',
                    secondary: '#218BFF',
                    background: '#0D1421',
                    cardBg: '#161B26',
                    textColor: '#F0F6FC'
                }
            };
            
            const theme = themes[themeName];
            if (theme) {
                document.documentElement.style.setProperty('--primary-color', theme.primary);
                document.documentElement.style.setProperty('--secondary-color', theme.secondary);
                document.documentElement.style.setProperty('--bg-color', theme.background);
                document.documentElement.style.setProperty('--card-bg', theme.cardBg);
                document.documentElement.style.setProperty('--text-color', theme.textColor);
                
                localStorage.setItem('baguwen_theme', themeName);
                showAlert('‰∏ªÈ¢ò', `Â∑≤ÂàáÊç¢Âà∞${theme.name}‰∏ªÈ¢ò`);
            }
        }

        // Âä†ËΩΩ‰øùÂ≠òÁöÑ‰∏ªÈ¢ò
        function loadTheme() {
            const savedTheme = localStorage.getItem('baguwen_theme') || 'dark';
            setTheme(savedTheme);
        }

        // Âú®ÂàùÂßãÂåñÊó∂Âä†ËΩΩ‰∏ªÈ¢ò
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
        });

        // ÊêúÁ¥¢ÂäüËÉΩ
        function searchQuestions(keyword) {
            const filteredQuestions = questions.filter(q => 
                q.title.toLowerCase().includes(keyword.toLowerCase()) ||
                q.content.toLowerCase().includes(keyword.toLowerCase()) ||
                (q.category && q.category.toLowerCase().includes(keyword.toLowerCase()))
            );
            return filteredQuestions;
        }

        // Â§ç‰π†Ê®°ÂºèÊâ©Â±ï
        function startQuickReview(count = 10) {
            if (questions.length === 0) {
                showAlert('ÊèêÁ§∫', 'ÊöÇÊó†È¢òÁõÆÂèØ‰æõÂ§ç‰π†');
                return;
            }
            
            const reviewQuestions = isRandomMode ? 
                shuffleArray([...questions]).slice(0, count) :
                questions.slice(0, count);
            
            // ËøôÈáåÂèØ‰ª•ÂÆûÁé∞Âø´ÈÄüÂ§ç‰π†Ê®°Âºè
            showAlert('Âø´ÈÄüÂ§ç‰π†', `ÂºÄÂßã${count}È¢òÂø´ÈÄüÂ§ç‰π†Ê®°Âºè`);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // ÈîôÈ¢òÊú¨ÂäüËÉΩ
        function getWrongQuestions() {
            const wrongQuestionIds = reviewRecords
                .filter(r => !r.isCorrect)
                .map(r => r.questionId);
            
            const uniqueWrongIds = [...new Set(wrongQuestionIds)];
            return questions.filter(q => uniqueWrongIds.includes(q.id));
        }

        function reviewWrongQuestions() {
            const wrongQuestions = getWrongQuestions();
            if (wrongQuestions.length === 0) {
                showAlert('ÊèêÁ§∫', 'ÊöÇÊó†ÈîôÈ¢òËÆ∞ÂΩï');
                return;
            }
            
            // ËÆæÁΩÆ‰∏∫ÈîôÈ¢òÂ§ç‰π†Ê®°Âºè
            questions = wrongQuestions;
            currentQuestionIndex = 0;
            showCurrentQuestion();
            showAlert('ÈîôÈ¢òÂ§ç‰π†', `ÂºÄÂßãÂ§ç‰π†${wrongQuestions.length}ÈÅìÈîôÈ¢ò`);
        }

        // Â≠¶‰π†ËÆ°ÂàíÂäüËÉΩ
        function createStudyPlan() {
            const totalQuestions = questions.length;
            if (totalQuestions === 0) {
                showAlert('ÊèêÁ§∫', 'ËØ∑ÂÖàÊ∑ªÂä†È¢òÁõÆ');
                return;
            }
            
            const dailyTarget = Math.ceil(totalQuestions / 7); // ‰∏ÄÂë®ÂÜÖÂÆåÊàê
            const plan = {
                totalQuestions,
                dailyTarget,
                startDate: new Date().toISOString().split('T')[0],
                progress: 0
            };
            
            localStorage.setItem('baguwen_study_plan', JSON.stringify(plan));
            showAlert('Â≠¶‰π†ËÆ°Âàí', `Â∑≤ÂàõÂª∫Â≠¶‰π†ËÆ°ÂàíÔºöÊØèÊó•Â§ç‰π†${dailyTarget}È¢òÔºåÈ¢ÑËÆ°7Â§©ÂÆåÊàê`);
        }

        // ÁªüËÆ°ÂõæË°®ÔºàÁÆÄÂçïÁöÑÊñáÊú¨ÂõæË°®Ôºâ
        function generateProgressChart() {
            const last7Days = [];
            const today = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                const dayRecords = reviewRecords.filter(r => 
                    r.reviewTime.includes(dateStr)
                );
                
                last7Days.push({
                    date: dateStr,
                    count: dayRecords.length,
                    correct: dayRecords.filter(r => r.isCorrect).length
                });
            }
            
            return last7Days;
        }

        // ÂØºÂá∫‰∏∫PDFÔºàÁÆÄÂçïÂÆûÁé∞Ôºâ
        function exportToPDF() {
            let content = 'ÂÖ´ËÇ°ÊñáÂ§ç‰π†Á≥ªÁªü - Â≠¶‰π†Êä•Âëä\n\n';
            content += `ÊÄªÈ¢òÁõÆÊï∞Ôºö${questions.length}\n`;
            content += `Â∑≤ÁªÉ‰π†Ôºö${new Set(reviewRecords.map(r => r.questionId)).size}\n`;
            content += `ÊÄªÊ≠£Á°ÆÁéáÔºö${reviewRecords.length > 0 ? (reviewRecords.filter(r => r.isCorrect).length / reviewRecords.length * 100).toFixed(1) : 0}%\n\n`;
            
            content += 'ÊúÄËøëÁªÉ‰π†ËÆ∞ÂΩïÔºö\n';
            reviewRecords.slice(0, 10).forEach((record, index) => {
                content += `${index + 1}. ${record.questionTitle} - ${record.isCorrect ? 'Ê≠£Á°Æ' : 'ÈîôËØØ'} - ${record.reviewTime}\n`;
            });
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Â≠¶‰π†Êä•Âëä_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ÈîÆÁõòÂø´Êç∑ÈîÆÊâ©Â±ï
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        if (!document.getElementById('manage-page').classList.contains('hidden')) {
                            saveQuestion();
                        }
                        break;
                    case 'n':
                        e.preventDefault();
                        if (!document.getElementById('manage-page').classList.contains('hidden')) {
                            addNewQuestion();
                        }
                        break;
                    case 'e':
                        e.preventDefault();
                        exportData();
                        break;
                }
            }
        });

        // Ê∑ªÂä†Êõ¥Â§öÂÆûÁî®Â∑•ÂÖ∑ÂáΩÊï∞
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function getQuestionsByCategory() {
            const categories = {};
            questions.forEach(q => {
                const category = q.category || 'Êú™ÂàÜÁ±ª';
                if (!categories[category]) {
                    categories[category] = [];
                }
                categories[category].push(q);
            });
            return categories;
        }

        function getQuestionsByDifficulty() {
            const difficulties = { EASY: [], MEDIUM: [], HARD: [] };
            questions.forEach(q => {
                if (difficulties[q.difficulty]) {
                    difficulties[q.difficulty].push(q);
                }
            });
            return difficulties;
        }

        // ÂÖ®Â±èÊ®°Âºè
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Â§úÈó¥Ê®°ÂºèÔºàÊä§ÁúºÊ®°ÂºèÔºâ
        function toggleNightMode() {
            document.body.classList.toggle('night-mode');
            localStorage.setItem('baguwen_night_mode', document.body.classList.contains('night-mode'));
        }

        // ËØ≠Èü≥ÂêàÊàêËÆæÁΩÆ
        function updateSpeechSettings() {
            const rate = document.getElementById('speech-rate').value;
            localStorage.setItem('baguwen_speech_rate', rate);
        }

        // Âä†ËΩΩËØ≠Èü≥ËÆæÁΩÆ
        function loadSpeechSettings() {
            const savedRate = localStorage.getItem('baguwen_speech_rate') || '1';
            document.getElementById('speech-rate').value = savedRate;
        }

        // Â§ç‰π†ÊèêÈÜí
        function setReviewReminder() {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        setTimeout(() => {
                            new Notification('ÂÖ´ËÇ°ÊñáÂ§ç‰π†ÊèêÈÜí', {
                                body: 'ËØ•Â§ç‰π†‰∫ÜÔºÅÂùöÊåÅÊØèÂ§©ÁªÉ‰π†ÔºåÊèêÈ´òÊäÄÊúØÊ∞¥Âπ≥„ÄÇ',
                                icon: '/favicon.ico'
                            });
                        }, 30 * 60 * 1000); // 30ÂàÜÈíüÂêéÊèêÈÜí
                    }
                });
            }
        }

        // ÊÄßËÉΩÁõëÊéß
        function logPerformance(action, startTime) {
            const endTime = performance.now();
            const duration = endTime - startTime;
            console.log(`${action} ËÄóÊó∂: ${duration.toFixed(2)}ms`);
        }

        // ÈîôËØØÂ§ÑÁêÜ
        window.addEventListener('error', function(e) {
            console.error('ÂÖ®Â±ÄÈîôËØØ:', e);
            showAlert('ÈîôËØØ', 'ÂèëÁîü‰∫Ü‰∏Ä‰∏™ÈîôËØØÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï');
        });

        // Á¶ªÁ∫øÊîØÊåÅÊ£ÄÊµã
        window.addEventListener('online', function() {
            showAlert('ÁΩëÁªú', 'ÁΩëÁªúËøûÊé•Â∑≤ÊÅ¢Â§ç');
        });

        window.addEventListener('offline', function() {
            showAlert('ÁΩëÁªú', 'ÁΩëÁªúËøûÊé•Â∑≤Êñ≠ÂºÄÔºåÂ∫îÁî®Â∞ÜÁªßÁª≠Âú®Á¶ªÁ∫øÊ®°Âºè‰∏ãÂ∑•‰Ωú');
        });

        console.log('üß† ÂÖ´ËÇ°ÊñáÂ§ç‰π†Á≥ªÁªüÂ∑≤Âä†ËΩΩÂÆåÊàêÔºÅ');
        console.log('üìö Á≥ªÁªüÂäüËÉΩÔºö');
        console.log('   - È¢òÁõÆÁÆ°ÁêÜÔºàÂ¢ûÂà†ÊîπÊü•Ôºâ');
        console.log('   - Êô∫ËÉΩÂ§ç‰π†ÔºàÈ°∫Â∫è/ÈöèÊú∫Ôºâ');
        console.log('   - ËØ≠Èü≥ÂäüËÉΩÔºàÊúóËØª/ËØÜÂà´Ôºâ');
        console.log('   - ÁªüËÆ°ÂàÜÊûê');
        console.log('   - Êï∞ÊçÆÂØºÂÖ•ÂØºÂá∫');
        console.log('   - Â§ö‰∏ªÈ¢òÂàáÊç¢');
        console.log('üí° Âø´Êç∑ÈîÆÔºöSpace(ËØ≠Èü≥) Enter(Êèê‰∫§) ‚Üê‚Üí(ÂàáÈ¢ò)');
    </script>
</body>
</html>
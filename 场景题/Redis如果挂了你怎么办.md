# Redis 如果挂了，你怎么办？🛑

面试官问这个问题，其实不是让你讲怎么“修 Redis”，而是考察你对高可用、降级、限流、容灾等设计的理解和预案。下面是标准思路👇

---

## 1️⃣ 监控与快速发现 🚨

- 必须有**Redis监控**（如Prometheus、运维平台），能及时发现异常（超时、连接不上、QPS骤降等）。
- 业务代码也可加**调用成功率、超时等监控**，发现问题自动触发降级。

---

## 2️⃣ 高可用部署与故障切换 🏰

- 生产环境一般用**主从复制、哨兵模式、Redis Cluster**等高可用方案，自动故障转移，减少挂掉概率。
- 也可以有**备用实例**、甚至跨机房部署，主挂了能秒级切换到备。

---

## 3️⃣ 降级与限流方案 ⚡

- 明确哪些场景“必须依赖Redis”，提前设计**降级方案**，如：
  - **秒杀、抢购等高并发业务**：Redis挂了可切到DB，但要**加限流**，防止数据库被打爆。
  - **缓存降级**：Redis挂了可用**本地缓存**（如Caffeine、Guava），但要评估数据一致性能否接受。

---

## 4️⃣ 自动熔断/开关机制 🕹️

- 设计“**一键切换**”或开关，Redis不可用自动熔断、流量切换到降级方案，减少人工操作时间。
- 预案（应急预案）提前配置好，线上故障可自动或一键执行。

---

## 5️⃣ 数据备份与冗余 💾

- 关键业务数据可**定期备份**，如同步到DB、其它缓存系统（如MongoDB等）以备应急。
- 冗余设计是大厂常规操作，防止单点故障。

---

## 6️⃣ 总结 📝

- **Redis挂了，要能自动发现、自动切换、降级限流，保证核心业务不挂，部分功能可用。**
- 这些措施**要提前设计好、压测验证**，不是等挂了再想办法！

---

> **一句话总结：**
> Redis挂了不是“怎么修”，而是提前设计好高可用、降级、限流、备份等机制，确保系统在极端情况下依然可控、可用！🛡️
### 问题

**Spring 中的单例 Bean 是线程安全的吗？为什么？**

---

#### 详细解释

Spring 框架中，默认情况下 Bean 是单例（Singleton Scope）的。**单例 Bean 并不等于线程安全**。  
所谓单例，是指在整个 Spring 容器中只会创建一份 Bean 实例，所有请求都会返回同一个对象引用。

但线程安全问题的本质在于：**多个线程操作同一个对象时，如果对象内部存在可变的状态（成员变量），没有合适同步措施就会有并发冲突和数据不一致的问题。**

- **如果 Bean 是无状态的**（如工具类、DAO 层、配置类，只读属性），一般不会有线程安全问题。
- **如果 Bean 是有状态的**（如成员变量用于保存用户 Session、计数器等），当多个线程同时访问时，可能会出现数据错乱。

**场景举例：**

```java
@Component
public class CounterService {
    private int count = 0; // 这是一个有状态的变量

    public void increment() {
        count++; // 非线程安全
    }
}
```
在高并发下，`count++` 可能会出现丢失、覆盖等情况，因为所有请求操作的是同一个实例的 `count` 变量。

**如何保证线程安全？**
- 局部变量是线程安全的（方法内部变量）
- 可以使用 `ThreadLocal` 保存线程独立的数据
- 采用原子类（如 AtomicInteger），或加锁（如 synchronized）
- 避免在单例 Bean 中保存可变状态

---

#### 总结性回答（复习提示词）

> Spring 单例 Bean 并不保证线程安全；与线程安全无关，需开发者自行保证。无状态 Bean 通常安全，有状态需加锁或避免状态共享。
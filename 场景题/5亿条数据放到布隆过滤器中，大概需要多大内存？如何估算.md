# 5亿条数据放到布隆过滤器中，大概需要多大内存？如何估算？

布隆过滤器（Bloom Filter）的内存占用，取决于：
- 元素个数 n
- 期望误判率 p
- 位数组长度 m（bit数）
- 哈希函数数量 k

## 估算公式

布隆过滤器的位数组长度 m 的计算公式为：

```
m = - (n * ln(p)) / (ln(2))^2
```
- n：待存储元素数量（本例 5亿 = 500,000,000）
- p：期望的误判率（如 0.001 = 千分之一）

哈希函数数量 k 的公式为：

```
k = (m / n) * ln(2)
```

---

## 示例计算（5亿数据，误判率0.001）

- n = 500,000,000
- p = 0.001
- ln(0.001) ≈ -6.9078
- (ln 2)^2 ≈ 0.4809

```
m = - (5e8 * ln(0.001)) / (ln(2))^2
  = - (500,000,000 × -6.9078) / 0.4809
  = (3,453,900,000) / 0.4809
  ≈ 7,184,000,000 bit
```

### 换算为字节/MB/GB：

- 7,184,000,000 bit ÷ 8 = 898,000,000 byte ≈ 856 MB ≈ 0.836 GB

---

## 不同误判率下的内存占用（近似）

| 误判率       | bit数         | 字节        | MB     | GB      |
| ------------ | ------------- | ----------- | ------ | ------- |
| 0.1% (0.001) | 7,184,000,000 | 898,000,000 | 856 MB | 0.836GB |
| 1%  (0.01)   | 4,787,000,000 | 598,000,000 | 570 MB | 0.557GB |

---

## 总结

- 5亿数据 + 0.1%误判率，约需**856MB**内存
- 5亿数据 + 1%误判率，约需**570MB**内存
- 误判率越低、数据量越大，占用内存越多

---

### 计算步骤总结

1. 明确 n、p，代入公式 m = - (n * ln(p)) / (ln2)^2 求 bit数
2. 换算为字节（÷8）、MB（÷1024^2）、GB（÷1024^3）

> 💡 **一句话总结：布隆过滤器存5亿数据，误判率千分之一时大约需856MB内存，内存占用=数据量和误判率共同决定，用公式一算就有答案。**
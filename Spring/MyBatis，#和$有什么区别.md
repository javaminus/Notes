这是 MyBatis 中非常重要也非常容易出错的一点。`#` 和 `$` 都是参数占位符，但它们有**本质区别**，关系到：

- **SQL注入安全**
- **类型处理**
- **语句预编译**
- **动态 SQL 拼接**

------

## ✅ 一句话总结区别：

> `#` 是**安全绑定参数**（使用占位符`?`），防注入；
>  `$` 是**字符串直接拼接**，有 SQL 注入风险。

------

## 🔍 详细对比

| 特性         | `#{}`（推荐）                   | `${}`（小心使用）                        |
| ------------ | ------------------------------- | ---------------------------------------- |
| 替换方式     | **使用 JDBC 的 ? 占位符**       | **直接字符串拼接进 SQL**                 |
| 编译方式     | **预编译**（PreparedStatement） | 非预编译（Statement）                    |
| SQL 注入风险 | ✅ 安全，自动处理引号、转义      | ❌ 有风险，直接拼接可能被注入             |
| 使用场景     | ✅ 普通参数传值（条件、字段值）  | ❗ 表名、列名、ORDER BY、LIMIT 等特殊场景 |
| 类型处理     | MyBatis 会自动根据类型转换      | 不做类型转换，直接拼接                   |

------

## 🧪 示例比较

### ✅ 使用 `#{}`：

```
SELECT * FROM user WHERE name = #{name}
```

如果参数是 `name = "张三"`，最终 SQL 是：

```
SELECT * FROM user WHERE name = ?
# JDBC 会自动绑定参数为 '张三'
```

✔️ 安全、推荐使用。

------

### ❌ 使用 `${}`：

```
SELECT * FROM user WHERE name = '${name}'
```

如果传入的是 `张三' OR '1'='1`，最终 SQL 是：

```
SELECT * FROM user WHERE name = '张三' OR '1'='1'
```

✔️ 会返回**所有数据**，典型的 **SQL 注入漏洞**！

------

## 🎯 使用场景建议

| 场景            | 推荐写法                   | 说明                                 |
| --------------- | -------------------------- | ------------------------------------ |
| 传普通参数      | `#{param}`                 | 自动绑定类型，防止注入               |
| 动态表名/列名   | `${table}`                 | 字符串拼接，**必须保证参数安全合法** |
| 动态排序字段    | `ORDER BY ${col}`          | 小心拼接排序字段，避免被注入         |
| 动态 LIMIT 分页 | `LIMIT ${start}, ${limit}` | JDBC 不支持 LIMIT 绑定，只能拼接     |

------

## 🔐 小技巧：怎么安全使用 `${}`？

```
<select id="queryByColumn" resultType="User">
  SELECT ${colName} FROM user
  WHERE id = #{id}
</select>
```

你应该事先**白名单校验参数值**：

```
if (!Set.of("name", "age", "email").contains(colName)) {
    throw new IllegalArgumentException("非法列名");
}
```

------

## ✅ 总结记忆：

| 写法  | 替换方式   | 注入风险 | 用途                                   |
| ----- | ---------- | -------- | -------------------------------------- |
| `#{}` | 安全绑定 ? | ❌ 安全   | 大多数情况用它                         |
| `${}` | 字符串拼接 | ⚠️ 易注入 | 表名、字段名、排序、分页等特殊场景使用 |

------

如果你想看实际 SQL 执行日志（MyBatis打印出来的），我可以给你写个 demo 展示两者的区别。是否需要？
## 问题：JVM中对象的生命周期和引用类型有哪些？如何影响垃圾回收？

### 详细解释

在JVM中，对象的生命周期贯穿**创建、使用、不可达、等待回收、被回收**等阶段。理解对象的生命周期和引用类型，有助于优化内存管理和理解垃圾回收器（GC）的行为。

#### 1. 对象生命周期

1. **创建**：通过`new`、反射、克隆等方式分配在堆内存。
2. **使用**：对对象进行方法调用、属性访问等操作。
3. **不可达**：无任何引用指向该对象，即“可达性分析算法”无法从GC Roots访问到该对象。
4. **等待回收**：对象进入“可回收区域”，等待GC回收。
5. **被回收**：在合适的GC时机被移除，释放内存。

#### 2. 对象的引用类型

JVM从Java 1.2起，提供了**四种引用类型**，根据引用强度不同，对GC有不同影响：

- **强引用（Strong Reference）**  
  普通对象引用，最常见，如`Object obj = new Object();`。只要有强引用，GC永远不会回收该对象。
- **软引用（Soft Reference）**  
  用于实现内存敏感的缓存。内存不足时，GC会回收软引用指向的对象。Java提供`SoftReference<T>`类。
- **弱引用（Weak Reference）**  
  更弱，GC一发现弱引用对象就会回收。常用于实现ThreadLocal、规范映射等。Java提供`WeakReference<T>`。
- **虚引用（Phantom Reference）**  
  最弱，不能通过它访问对象，仅用于在对象被回收时接收一个系统通知（finalization）。Java提供`PhantomReference<T>`。

#### 3. 场景与例子

**场景1：内存敏感缓存（软引用）**

```java
SoftReference<MyObject> cache = new SoftReference<>(new MyObject());
```
> 在内存紧张时，JVM会自动回收`MyObject`，适合实现如图片缓存。

**场景2：ThreadLocal中的弱引用**

ThreadLocal内部使用弱引用保存线程变量，线程结束后变量可被回收，防止内存泄漏。

**场景3：虚引用用于资源释放通知**

使用虚引用配合引用队列（ReferenceQueue）追踪对象回收，做特殊清理动作。

#### 4. GC如何根据引用类型回收对象

- **强引用**：对象不会被回收
- **软引用**：内存不足时回收
- **弱引用**：下一次GC必回收
- **虚引用**：任何时候都可回收，主要用于回收通知

### 总结性回答/提示词

- 对象生命周期：创建→使用→不可达→等待回收→被回收
- 四种引用类型：强、软、弱、虚
- 引用强度影响GC回收时机
- 典型应用：缓存（软引用）、ThreadLocal（弱引用）、回收通知（虚引用）
- 复习提示：**“强软弱虚四种引用，引用越弱越易被GC”**
## Redis 高级数据结构及其使用场景

---

### 1. Hash（哈希表）

- **适用场景**：对象存储，如用户信息（id、昵称、邮箱等），购物车单条数据。
- **优点**：节省内存、字段可独立操作、支持原子性。
- **案例**：`HMSET user:1001 name "Tom" age "25"`

---

### 2. List（列表）

- **适用场景**：消息队列、任务队列、时间线、最新消息流。
- **优点**：支持两端插入/弹出（队列、栈），可范围查询。
- **案例**：`LPUSH chat:room1 "hello"`

---

### 3. Set（集合）

- **适用场景**：标签系统、去重、共同好友、抽奖、关注列表。
- **优点**：元素唯一、支持交集并集差集等高效集合运算。
- **案例**：`SADD user:1001:friends 1002 1003`

---

### 4. Sorted Set（有序集合 ZSet）

- **适用场景**：排行榜、计分板、延时任务、带优先级的队列。
- **优点**：自动排序、可按分数范围查找、排名查询。
- **案例**：`ZADD game:rank 100 "tom" 200 "jerry"`

---

### 5. HyperLogLog

- **适用场景**：大规模数据的基数（去重计数），如独立 IP 统计、UV 统计。
- **优点**：极低内存消耗，支持大数据量近似计数。
- **缺点**：只能统计数量，不能获取具体元素。
- **案例**：`PFADD site:uv 192.168.1.1`

---

### 6. BitMap

- **适用场景**：用户签到、状态记录、活跃用户统计、二值特征存储。
- **优点**：极致节省空间，支持位操作。
- **案例**：`SETBIT user:sign:20250701 1001 1`

---

### 7. Geo（地理空间）

- **适用场景**：附近的人、LBS 服务、地理位置排序和范围查询。
- **优点**：可存储经纬度信息，支持距离和范围计算。
- **案例**：`GEOADD city:shanghai 121.47 31.23 "user1001"`

---

### 8. Stream（流式数据结构）

- **适用场景**：消息流、日志收集、事件溯源、实时数据管道。
- **优点**：支持高性能消费组、阻塞读写、消息持久化。
- **案例**：`XADD log:sys * level info msg "start"`

---

## 总结

Redis 的高级数据结构设计独特，适合多种业务场景：  
- Hash 适合对象属性存储，  
- List 适合队列，  
- Set/Sorted Set 适合集合运算与排行榜，  
- HyperLogLog/BitMap/Geo/Stream 适合大数据量、空间/时间/地理特征的高效处理。  
  合理选用数据结构，可极大提升系统性能与开发效率。

## Redis 高级数据结构——面试官深问问题与参考答案

---

### 1. 为什么要用 Redis 的高级数据结构而不是只用 String？

**参考答案：**  
高级数据结构（如 List、Set、ZSet、Hash 等）可以高效地完成复杂业务需求，节省内存和网络带宽。例如排行榜、消息队列、去重、对象存储等场景用高级结构能直接支持高效操作，而 String 只能存储简单数据，复杂操作需反复序列化/反序列化，效率低下。

---

### 2. ZSet 和 List 有什么区别？各自适用场景？

**参考答案：**  
ZSet（有序集合）每个元素有分数，自动排序，适合排行榜、优先级队列等场景；List 是有序链表，支持两端插入/弹出，适合消息队列、时间线等场景。ZSet 支持范围查询和排名，List 更适合先进先出或栈操作。

---

### 3. HyperLogLog 能实现哪些功能？它的误差和局限是什么？

**参考答案：**  
HyperLogLog 适合大数据量去重计数（如 UV、独立用户统计），内存占用极低。缺点是只能统计“有多少”，无法列出具体元素，且有一定的误差（一般为 0.81% 左右），对高精度要求场景不适合。

---

### 4. Hash 适合什么场景？和单独用 String 有什么区别？

**参考答案：**  
Hash 适合存储对象类型数据（如用户信息），每个字段可单独读写，比用多个 String 节省内存（小的 Hash Redis 会做特殊优化），操作也更高效。用 String 需要序列化/反序列化整个对象，修改单字段不方便。

---

### 5. Bitmap 适合哪些高效场景？如何实现用户签到统计？

**参考答案：**  
Bitmap 适合大规模二值状态标记，如用户签到、活跃、在线情况。一个用户一天一个 bit，节省空间。统计签到天数、连续签到等用位运算即可高效实现。

---

### 6. Stream 和 List 区别？Stream 适合什么业务？

**参考答案：**  
Stream 是消息队列的进阶版，支持消息持久化、消费组、阻塞读写、消息 ID 等，适合分布式日志、消息中台、实时数据总线等场景。List 是简单队列，无消费确认和持久化能力。

---

### 7. Redis Geo 结构用在哪？如何查找“附近的人”？

**参考答案：**  
Geo 可存储经纬度，支持范围、距离等空间查询。查找附近的人时，先用 GEOADD 存用户位置，再用 GEORADIUS 按距离查询目标范围内的所有用户，效率高于传统数据库。

---

### 8. Set 和 Sorted Set 在去重和排序上的区别？

**参考答案：**  
Set 只保证元素唯一，不排序，适合去重。Sorted Set 保证唯一且有序，适合需要排序的去重场景，如积分排行榜等。

---

## 总结

面试深问时，需结合实际业务场景，理解各结构的优缺点、适用点和实现细节，并能举例说明其业务价值和性能优势。
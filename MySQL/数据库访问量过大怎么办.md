当数据库访问量过大时，容易造成系统压力大、响应变慢甚至宕机。下面从你提到的六个方面，详细说明应对策略：

---

### 1. 创建或优化索引

- **作用**：索引能极大提升查询效率，减少全表扫描带来的压力。
- **做法**：
    - 分析慢查询日志，找出高频和慢查询字段，建立合适的单列或联合索引。
    - 删除冗余或重复的索引，避免维护成本过高。
    - 定期重建、重组索引，提升索引利用率。
    - 优化索引结构，选择合适的数据结构（如B+树、哈希索引等）。

---

### 2. 查询优化

- **作用**：减少不必要的数据库访问和数据量，降低数据库负载。
- **做法**：
    - 尽量只查询所需字段，避免`SELECT *`。
    - 写高效SQL，避免子查询、嵌套查询等低效语句。
    - 合理分页，避免一次性拉取大量数据。
    - 使用EXPLAIN分析SQL执行计划，发现性能瓶颈。
    - 避免N+1查询（如ORM不合理导致的多次SQL）。

---

### 3. 避免索引失效

- **作用**：确保所有关键查询都能用到索引，提升性能。
- **做法**：
    - WHERE条件不要对索引列做函数、运算或隐式类型转换。
    - 联合索引要遵循最左前缀原则。
    - LIKE查询尽量用右模糊（如`name LIKE 'abc%'`），避免左模糊。
    - 对应类型匹配，避免数据类型不一致导致索引失效。
    - 避免对索引列使用`!=`、`<>`、`IS NULL`等操作。

---

### 4. 读写分离

- **作用**：将数据库的读操作和写操作分开，减轻主库压力，提升整体吞吐量。
- **做法**：
    - 部署主从数据库架构，主库负责写，从库负责读。
    - 应用层根据业务类型路由读写请求。
    - 使用中间件（如MyCat、Atlas等）自动实现读写分离。

---

### 5. 优化数据库表

- **作用**：合理的表结构设计减少存储和查询压力。
- **做法**：
    - 规范化表结构，避免冗余数据，但也要适当反规范化提升查询效率。
    - 拆分大表（水平分表、垂直分表），减少单表数据量。
    - 合理选择字段类型，避免大字段（如TEXT、BLOB）频繁查询。
    - 清理历史或无用数据，减小表体积。

---

### 6. 使用缓存技术

- **作用**：将热点数据缓存在内存中，减少数据库直接访问次数，提升响应速度。
- **做法**：
    - 利用Redis、Memcached等内存数据库缓存热点数据。
    - 静态数据、配置、排行榜等用缓存直接返回。
    - 采用本地缓存（如Guava Cache）或分布式缓存。
    - 设计合理的缓存失效策略，保证数据一致性。
    - 防止缓存穿透、雪崩等常见问题。

---

## 总结表格

| 优化方向      | 具体措施                                                  |
| ------------- | --------------------------------------------------------- |
| 创建/优化索引 | 建立高效索引、删除冗余索引、定期重建、选用合适结构        |
| 查询优化      | 精简字段、优化SQL、合理分页、分析执行计划、避免N+1        |
| 避免索引失效  | 不对索引列用函数/运算、守最左前缀、类型匹配、避免左模糊等 |
| 读写分离      | 主从架构、请求路由、使用中间件                            |
| 优化数据库表  | 规范化/反规范化、表拆分、字段优化、清理历史数据           |
| 使用缓存技术  | Redis/Memcached、本地或分布式缓存、合理失效策略           |

如需某一方向更详细的技术实现、案例或疑难排查方法，欢迎补充说明！

## 面试官可能追问的问题与参考答案

### 1. 如何定位数据库的瓶颈？
- 答：可通过慢查询日志、性能监控工具（如MySQL Performance Schema、SHOW PROCESSLIST）、EXPLAIN分析SQL、监控CPU/IO、锁等待等多维度定位。

---

### 2. 如何处理缓存与数据库的数据一致性？
- 答：可采用先更新数据库再删除/更新缓存、延迟双删策略、消息队列异步更新等方式保证一致性。

---

### 3. 主从延迟带来哪些问题？如何解决？
- 答：主从延迟会导致从库读取到旧数据，可通过读写分区、强制主库读、主从延迟监控与告警等方式应对。

---

### 4. 如何避免缓存穿透、雪崩、击穿？
- 答：缓存穿透可用布隆过滤器/缓存空对象，雪崩可设置不同key的过期时间，击穿可加互斥锁/单线程加载。

---

### 5. 大表拆分后如何保证数据一致和查询效率？
- 答：通过分布式事务、全局唯一ID、分片键设计、路由层聚合等技术保障；查询时加缓存、路由优化、分库分表中间件。

---
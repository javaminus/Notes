åœ¨ Java ä¸­ï¼Œ**æ­£ç¡®åœ°åœæ­¢ä¸€ä¸ªçº¿ç¨‹** éœ€è¦é¿å… `Thread.stop()`ï¼ˆå·²åºŸå¼ƒï¼‰ï¼Œè€Œæ˜¯é‡‡ç”¨ **å®‰å…¨ã€å¯æ§çš„æ–¹å¼**ã€‚ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š

------

## **1. ä½¿ç”¨æ ‡å¿—ä½ï¼ˆæ¨èï¼‰**

**é€šè¿‡å…±äº«å˜é‡ï¼ˆvolatile å…³é”®å­—ï¼‰æ§åˆ¶çº¿ç¨‹çš„åœæ­¢**ï¼Œé€‚ç”¨äºå¤§å¤šæ•°æƒ…å†µã€‚

### **ç¤ºä¾‹ï¼š**

```java
class MyTask implements Runnable {
    private volatile boolean running = true; // æ ‡å¿—ä½

    @Override
    public void run() {
        while (running) {  // è½®è¯¢æ ‡å¿—ä½
            System.out.println("Thread running...");
            try { Thread.sleep(500); } catch (InterruptedException ignored) {}
        }
        System.out.println("Thread stopped.");
    }

    public void stop() {  // æä¾›åœæ­¢æ–¹æ³•
        running = false;
    }
}

public class StopThreadExample {
    public static void main(String[] args) throws InterruptedException {
        MyTask task = new MyTask();
        Thread thread = new Thread(task);
        thread.start();

        Thread.sleep(2000); // è¿è¡Œ 2 ç§’
        task.stop(); // é€šè¿‡æ ‡å¿—ä½åœæ­¢
    }
}
```

### **åŸç†**

- çº¿ç¨‹ä¸æ–­æ£€æŸ¥ `running`ï¼Œä¸€æ—¦å˜ä¸º `false`ï¼Œå°±å®‰å…¨é€€å‡ºã€‚
- `volatile` ç¡®ä¿å¯è§æ€§ï¼Œé¿å…çº¿ç¨‹ç¼“å­˜å¯¼è‡´çš„è¯»å–é”™è¯¯ã€‚

------

## **2. ä½¿ç”¨ interrupt()ï¼ˆæ¨èï¼‰**

**é€‚ç”¨äºå¯å“åº” InterruptedException çš„çº¿ç¨‹**ï¼Œæ¯”å¦‚ `sleep()`ã€`wait()`ã€`join()`ã€‚

### **ç¤ºä¾‹ï¼š**

```java
class InterruptTask implements Runnable {
    @Override
    public void run() {
        try {
            while (!Thread.currentThread().isInterrupted()) {
                System.out.println("Thread running...");
                Thread.sleep(500); // çº¿ç¨‹å¯èƒ½åœ¨ sleep é˜»å¡
            }
        } catch (InterruptedException e) {
            System.out.println("Thread interrupted.");
        }
    }
}

public class InterruptExample {
    public static void main(String[] args) throws InterruptedException {
        Thread thread = new Thread(new InterruptTask());
        thread.start();

        Thread.sleep(2000);
        thread.interrupt(); // å‘é€ä¸­æ–­ä¿¡å·
    }
}
```

### **åŸç†**

- `interrupt()` **ä¸ä¼šç›´æ¥ç»ˆæ­¢çº¿ç¨‹**ï¼Œè€Œæ˜¯è®¾ç½®**ä¸­æ–­æ ‡å¿—ä½**ã€‚
- çº¿ç¨‹åœ¨ `sleep()`ã€`wait()`ã€`join()` æ—¶ä¼šæŠ›å‡º `InterruptedException`ï¼Œå¯åœ¨ `catch` é‡Œè¿›è¡Œæ¸…ç†åé€€å‡ºã€‚

------

## **3. ç»“åˆ interrupt() å’Œ æ ‡å¿—ä½**

**é€‚ç”¨äºä¸è°ƒç”¨ sleep() ç­‰æ–¹æ³•çš„çº¿ç¨‹**ï¼Œéœ€è¦æ‰‹åŠ¨æ£€æŸ¥ `isInterrupted()`ã€‚

### **ç¤ºä¾‹ï¼š**

```java
class HybridTask implements Runnable {
    @Override
    public void run() {
        while (!Thread.currentThread().isInterrupted()) { // è½®è¯¢ä¸­æ–­çŠ¶æ€
            System.out.println("Thread running...");
            try { Thread.sleep(500); } catch (InterruptedException e) {
                Thread.currentThread().interrupt(); // é‡æ–°è®¾ç½®ä¸­æ–­æ ‡å¿—
                break;
            }
        }
        System.out.println("Thread stopped.");
    }
}

public class HybridExample {
    public static void main(String[] args) throws InterruptedException {
        Thread thread = new Thread(new HybridTask());
        thread.start();

        Thread.sleep(2000);
        thread.interrupt();
    }
}
```

### **åŸç†**

- ç»“åˆ `isInterrupted()` è½®è¯¢ + `interrupt()` è§¦å‘ `InterruptedException`ï¼Œæ›´çµæ´»ã€‚

è¿™é‡Œçš„æ‰“å°ç»“æœï¼š

```
Thread running...

Thread running...

Thread running...

Thread running...

Thread stopped.

å½“çº¿ç¨‹çš„interrputä¸ºtrueçš„æ—¶å€™ï¼Œç„¶åè°ƒç”¨sleep()å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¿™ä¸ªæ—¶å€™interrputåˆä¼šå˜æˆfalseï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å°†å…¶æ”¹ä¸ºtrueã€‚
```



------

## **4. ä½¿ç”¨ FutureTask.cancel(true)**

é€‚ç”¨äº**çº¿ç¨‹æ± **ä¸­çš„ä»»åŠ¡ï¼Œ`cancel(true)` ä¼š**ä¸­æ–­æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡**ã€‚

### **ç¤ºä¾‹ï¼š**

```java
import java.util.concurrent.*;

public class FutureCancelExample {
    public static void main(String[] args) throws InterruptedException {
        ExecutorService executor = Executors.newSingleThreadExecutor();
        Future<?> future = executor.submit(() -> {
            while (!Thread.currentThread().isInterrupted()) {
                System.out.println("Task running...");
                try { Thread.sleep(500); } catch (InterruptedException e) {
                    break;
                }
            }
            System.out.println("Task stopped.");
        });

        Thread.sleep(2000);
        future.cancel(true); // å–æ¶ˆä»»åŠ¡å¹¶ä¸­æ–­çº¿ç¨‹
        executor.shutdown();
    }
}
```

### **åŸç†**

- `future.cancel(true)` ä¼š **ä¸­æ–­ä»»åŠ¡**ï¼Œå¦‚æœä»»åŠ¡æ”¯æŒ `InterruptedException`ï¼Œåˆ™ä¼šç«‹å³åœæ­¢ã€‚

------

## **âš ï¸ ä¸æ¨èçš„æ–¹æ³•**

### **1. Thread.stop()ï¼ˆå·²åºŸå¼ƒï¼Œå±é™©âš ï¸ï¼‰**

- **ä¼šç›´æ¥ç»ˆæ­¢çº¿ç¨‹ï¼Œä¸æ‰§è¡Œ finally ä»£ç å—ï¼Œå¯èƒ½å¯¼è‡´èµ„æºæœªé‡Šæ”¾ï¼**
- å¯èƒ½é€ æˆ**æ•°æ®ä¸ä¸€è‡´**ï¼ˆçº¿ç¨‹å¯èƒ½åœ¨å…³é”®æ“ä½œä¸­è¢«å¼ºåˆ¶ç»ˆæ­¢ï¼‰ã€‚

```java
Thread thread = new Thread(() -> {
    try {
        while (true) {
            System.out.println("Running...");
        }
    } finally {
        System.out.println("Cleanup..."); // å¯èƒ½ä¸ä¼šæ‰§è¡Œï¼
    }
});

thread.start();
thread.stop(); // âš ï¸ å¼ºåˆ¶åœæ­¢ï¼ˆä¸å®‰å…¨ï¼‰
```

------

## **æ€»ç»“**

| **æ–¹æ³•**                  | **é€‚ç”¨åœºæ™¯**                  | **ä¼˜ç¼ºç‚¹**                                |
| ------------------------- | ----------------------------- | ----------------------------------------- |
| **æ ‡å¿—ä½ï¼ˆvolatileï¼‰**    | é€‚ç”¨äºæ™®é€šçº¿ç¨‹                | âœ… å¯æ§ã€å®‰å…¨ âŒ å¯èƒ½å¯¼è‡´å»¶è¿Ÿåœæ­¢           |
| **interrupt()**           | `sleep()`ã€`wait()`ã€`join()` | âœ… å“åº”å¼åœæ­¢ âŒ çº¿ç¨‹éœ€è‡ªè¡Œæ£€æŸ¥             |
| **interrupt() + æ ‡å¿—ä½**  | éœ€è¦æ‰‹åŠ¨æ£€æŸ¥ä¸­æ–­              | âœ… æ›´çµæ´» âŒ ä»£ç ç¨å¤æ‚                     |
| **Future.cancel(true)**   | çº¿ç¨‹æ± ä»»åŠ¡                    | âœ… çº¿ç¨‹æ± å‹å¥½ âŒ ä»…é€‚ç”¨äº `ExecutorService` |
| **Thread.stop()ï¼ˆåºŸå¼ƒï¼‰** | ä¸æ¨è                        | âŒ ç ´åèµ„æºç®¡ç†ã€æ•°æ®ä¸€è‡´æ€§                |

**æœ€ä½³å®è·µï¼š**

- **æ™®é€šçº¿ç¨‹** â†’ **æ ‡å¿—ä½**
- **æ¶‰åŠ sleep()ã€wait()** â†’ **interrupt()**
- **é«˜æ•ˆç»ˆæ­¢çº¿ç¨‹** â†’ **interrupt() + æ ‡å¿—ä½**
- **çº¿ç¨‹æ± ä»»åŠ¡** â†’ **Future.cancel(true)**

æ­£ç¡®ç®¡ç†çº¿ç¨‹ç»ˆæ­¢ï¼Œé¿å…èµ„æºæ³„éœ²å’Œæ•°æ®æŸåï¼ğŸš€
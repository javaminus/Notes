# ğŸ§© Netty çš„çº¿ç¨‹æ¨¡å‹è¯¦è§£

Netty é‡‡ç”¨äº†åŸºäº **Reactor æ¨¡å‹** çš„å¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰æŠ€æœ¯æ¥é«˜æ•ˆå¤„ç†æµ·é‡å¹¶å‘ç½‘ç»œè¯·æ±‚ã€‚æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯å’Œå¯åŠ¨å‚æ•°ï¼ŒNetty æ”¯æŒä¸‰ç§ä¸»æµçº¿ç¨‹æ¨¡å‹ï¼š

---

## 1ï¸âƒ£ å•Reactorå•çº¿ç¨‹æ¨¡å‹

- **åŸç†**ï¼šä¸€ä¸ªçº¿ç¨‹ï¼ˆReactorï¼‰è´Ÿè´£æ‰€æœ‰äº‹ä»¶ï¼ˆè¿æ¥ã€è¯»å†™ï¼‰å¤„ç†å’Œåˆ†å‘ã€‚
- **ç‰¹ç‚¹**ï¼šæ¨¡å‹ç®€å•ï¼Œé€‚ç”¨äºè¿æ¥æ•°å°‘ã€ä¸šåŠ¡å¤„ç†å¿«çš„åœºæ™¯ã€‚
- **ç¼ºç‚¹**ï¼šå•çº¿ç¨‹å¤„ç†æ‰€æœ‰è¯·æ±‚ï¼Œæ— æ³•å……åˆ†åˆ©ç”¨å¤šæ ¸ CPUï¼Œåœ¨é«˜å¹¶å‘/é‡ä¸šåŠ¡åœºæ™¯ä¸‹å®¹æ˜“æˆä¸ºç“¶é¢ˆã€‚

![img](assets/15100432-8d55f7719d1ad6e3) 

**æµç¨‹å›¾ï¼š**
```
[å®¢æˆ·ç«¯1] \
[å®¢æˆ·ç«¯2]  >---[Reactorçº¿ç¨‹A]---[Handler]
[å®¢æˆ·ç«¯3] /
```

---

## 2ï¸âƒ£ å•Reactorå¤šçº¿ç¨‹æ¨¡å‹

- **åŸç†**ï¼šä¸€ä¸ª Reactor çº¿ç¨‹è´Ÿè´£äº‹ä»¶ç›‘å¬å’Œåˆ†å‘ï¼Œä¸šåŠ¡å¤„ç†äº¤ç”±å·¥ä½œçº¿ç¨‹æ± ï¼ˆWorker Poolï¼‰å®Œæˆã€‚
- **ä¼˜ç‚¹**ï¼šå¯ä»¥å¹¶å‘å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œæå‡ååé‡ã€‚
- **ç¼ºç‚¹**ï¼šReactor çº¿ç¨‹æ—¢è¦è´Ÿè´£è¿æ¥ï¼Œä¹Ÿè¦è´Ÿè´£ IO æ“ä½œï¼›è‹¥ IO å¤„ç†é˜»å¡ï¼Œè¿æ¥è¯·æ±‚å¯èƒ½è¢«å»¶è¿Ÿæˆ–æ‹’ç»ã€‚

![img](assets/15100432-a66dfaf29be6a116) 

**æµç¨‹å›¾ï¼š**
```
[å®¢æˆ·ç«¯]---[Reactorçº¿ç¨‹]---[Handlerçº¿ç¨‹æ± ]
```

---

## 3ï¸âƒ£ ä¸»ä»Reactorå¤šçº¿ç¨‹æ¨¡å‹ï¼ˆNetty é»˜è®¤ï¼‰

- **åŸç†**ï¼šä¸» Reactor åªè´Ÿè´£å¤„ç†è¿æ¥è¯·æ±‚ï¼Œå­ Reactorï¼ˆWorkerGroupï¼‰è´Ÿè´£å¤„ç†è¯»å†™äº‹ä»¶å’Œä¸šåŠ¡é€»è¾‘ã€‚
- **ä¼˜ç‚¹**ï¼šå……åˆ†åˆ©ç”¨å¤šæ ¸ CPUï¼Œè¿æ¥å’Œè¯»å†™åˆ†ç¦»ï¼Œæ”¯æŒé«˜å¹¶å‘ã€é«˜è´Ÿè½½åœºæ™¯ï¼Œæ‰©å±•æ€§å¼ºã€‚
- **åœ¨ Netty ä¸­**ï¼Œé€šå¸¸ BossGroup è´Ÿè´£ accept è¿æ¥ï¼ŒWorkerGroup è´Ÿè´£è¯»å†™å’Œå¤„ç†ä¸šåŠ¡ã€‚

![img](assets/15100432-1fdba5d7554cc9cc) 

**æµç¨‹å›¾ï¼š**
```
[å®¢æˆ·ç«¯]---[ä¸»Reactor(BossGroup)]---[å­Reactor(WorkerGroup)]---[Handlerçº¿ç¨‹æ± ]
```

---

## ğŸ› ï¸ Netty çš„ä¸»ä»å¤šçº¿ç¨‹å®ç°

```java
// åˆ›å»º BossGroupï¼ˆä¸»Reactorï¼‰å’Œ WorkerGroupï¼ˆå­Reactorï¼‰
EventLoopGroup bossGroup = new NioEventLoopGroup(1);
EventLoopGroup workerGroup = new NioEventLoopGroup();

ServerBootstrap b = new ServerBootstrap();
b.group(bossGroup, workerGroup)
 .channel(NioServerSocketChannel.class)
 .childHandler(new ChannelInitializer<SocketChannel>() {
     @Override
     protected void initChannel(SocketChannel ch) throws Exception {
         ch.pipeline().addLast(new YourHandler());
     }
 });
```
- bossGroup åªç®¡ç†è¿æ¥è¯·æ±‚
- workerGroup è´Ÿè´£æ•°æ®è¯»å†™ä¸ä¸šåŠ¡å¤„ç†

---

## ğŸš© æ€»ç»“

- **å•Reactorå•çº¿ç¨‹**ï¼šé€‚åˆä½è´Ÿè½½ã€ç®€å•åœºæ™¯
- **å•Reactorå¤šçº¿ç¨‹**ï¼šä¸šåŠ¡å¤„ç†å¯å¹¶å‘ï¼ŒIOä»æœ‰ç“¶é¢ˆ
- **ä¸»ä»Reactorå¤šçº¿ç¨‹ï¼ˆç”Ÿäº§æ¨èï¼‰**ï¼šé«˜å¹¶å‘ã€é«˜æ€§èƒ½ã€æ‰©å±•æ€§å¼º

> Netty é€šè¿‡çµæ´»çš„çº¿ç¨‹æ¨¡å‹é…ç½®ï¼Œèƒ½å¤Ÿé«˜æ•ˆåº”å¯¹å„ç§ç½‘ç»œé€šä¿¡åœºæ™¯ï¼Œå……åˆ†å‘æŒ¥å¤šæ ¸æœåŠ¡å™¨çš„æ€§èƒ½ä¼˜åŠ¿ã€‚